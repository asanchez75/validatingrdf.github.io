<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="hevea 2.23">
<link rel="stylesheet" type="text/css" href="bookHtml.css">
<title>Applications</title>
</head>
<body>
<a href="bookHtml012.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="bookHtml014.html"><img src="next_motif.gif" alt="Next"></a>
<hr>
<h1 class="chapter" id="sec174">Chapter 6  Applications</h1>
<p>
<a id="ch6"></a>
<a id="ch060Applications"></a></p><p>In this chapter we describe several applications of RDF validation. 
We start with the WebIndex, a medium-size linked data portal that was 
one of the earliest applications of ShEx. 
We describe it using ShEx and SHACL so the reader can see how both formalisms can be applied to describe RDF data.</p><p>In Section <a href="#ch060FHIR">6.2</a>, we present the use of ShEx in HL7 FHIR, 
which was one of the main motivations for the development of ShEx.</p><p>Section <a href="#ch070SciGraph">6.3</a> describes Springer Nature SciGraph, 
a real-world application of SHACL. Section <a href="#ch070DBpedia">6.4</a>
talks about validation use cases that have emerged in the DBpedia project.</p><p>We end the chapter with two exercises:
the validation of ShEx files, encoded as RDF using ShEx itself 
(Section <a href="#ch070ShExForShEx">6.5</a>), 
and the validation of SHACL shapes graphs in RDF using SHACL 
(Section <a href="#ch070ShaclInShacl">6.6</a>). 
These exercises help us understand the expressiveness of both formalisms.</p>
<h2 class="section" id="sec175">6.1  Describing a Linked Data Portal</h2>
<p>
<a id="ch6.sec1"></a></p><p>Linked data portals have emerged as a way to publish data on the Web in accordance with principles that 
improve data reuse and integration. 
As discussed in Section <a href="bookHtml008.html#LinkedDataPrinciples">1.1</a>, linked data uses RDF 
to make statements that establish relationships between arbitrary things. 
In this section, we consider one of the earliest practical applications of ShEx, 
the description of a real linked data portal, the WebIndex, and its data model. 
Some contents of this section have been taken from this paper [<a href="bookHtml019.html#LabraValidatingDescribingDataPortalsArxivVersion2017">58</a>] where 
we also compare the performance of two early implementations of ShEx and SHACL.</p><p>The WebIndex is a multi-dimensional measure of the World Wide Web’s contribution to development and human rights globally. 
In its latest edition (from 2014), it covers 81 countries and incorporates indicators that assess several areas such as universal access; 
freedom and openness; relevant content; and empowerment. 
Its first version provided a data portal where the data was obtained by transforming raw observations and precomputed values from Excel sheets into RDF. 
The second version added an approach to validation and computation that resulted in a verifiable version of the index data.</p><p>The WebIndex data model is based on the RDF Data Cube vocabulary [<a href="bookHtml019.html#RDFDataCube">24</a>]
and reuses several vocabularies such as Organization ontology [<a href="bookHtml019.html#Organization14">83</a>] and 
Dublin Core [<a href="bookHtml019.html#DublinCore">10</a>]. </p><p>Figure <a href="#SimplifiedModel">6.1</a> shows the main concepts of the data model. 
The boxes represent the different shapes of nodes that are published in the data portal.</p><blockquote class="figure"><div class="center"><hr class="c021"></div> 
<div class="center">
<img src="wiModel.png">
</div>

<a id="SimplifiedModel"></a>
<div class="caption"><table class="c002 cellpading0"><tr><td class="c018">Figure 6.1: Simplified WebIndex data model.</td></tr>
</table></div>
<div class="center"><hr class="c021"></div></blockquote><p>The main concept is an observation of type 
<code>wf:Observation</code> which has a float value 
<code>cex:value</code> for a given indicator, as well as the country, year, and dataset. 
Observations can be raw observations, which are obtained from an external source, or computed observations, 
which are obtained from other observations by computational processes. </p><p>A dataset contains a number of slices, each of which also contains a number of observations. 
Indicators are provided by an organization of type 
<code>org:Organization</code>, which is based on the Organization ontology. </p><p>Datasets are also published by organizations. </p><p>A sample from the DITU dataset provided by ITU (International Telecommunication Union) states 
that, in 2011, Spain had a value of 23.78 for the TU-B (<em>Broadband subscribers per 100 population</em>) indicator. 
This information is represented in Turtle as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:obs8165</span><span class="c011">
</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">qb:Observation,</span><span class="c011"> </span><span class="c011">wf:Observation</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">rdfs:label</span><span class="c011"> </span><span class="c011"><span class="c011">"ITU B in ESP"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">dct:issued</span><span class="c011"> </span><span class="c011"><span class="c011">"2013-05-30T09:15:00"</span></span><span class="c011">^^</span><span class="c011">xsd:dateTime</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">cex:indicator</span><span class="c011">   </span><span class="c011">:ITU_B</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">qb:dataSet</span><span class="c011">      </span><span class="c011">:DITU</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">cex:value</span><span class="c011">       </span><span class="c011"><span class="c011">"23.78"</span></span><span class="c011">^^</span><span class="c011">xsd:float</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">cex:ref</span><span class="c011">-</span><span class="c011">area</span><span class="c011">    </span><span class="c011">:Spain</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">cex:ref</span><span class="c011">-</span><span class="c011">year</span><span class="c011">    </span><span class="c011"><span class="c011">"2011"</span></span><span class="c011">^^</span><span class="c011">xsd:gYear</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">cex:computation</span><span class="c011"> </span><span class="c011">:comp234</span><span class="c011"> .</span></td></tr>
</table><p>Data following the WebIndex data model is richly interrelated.
Observations are linked to indicators and to datasets. 
Datasets contain links to slices. Slices have links both to indicators and back to observations.
Both datasets and indicators are linked to the organizations by which they are published or made available.
Such links are illustrated in the following example:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:DITU</span><span class="c011"> </span><span class="c011">a</span><span class="c011">        </span><span class="c011">qb:DataSet</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">qb:structure</span><span class="c011">  </span><span class="c011">wf:DSD</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">rdfs:label</span><span class="c011">    </span><span class="c011"><span class="c011">"ITU Dataset"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">dct:publisher</span><span class="c011"> </span><span class="c011">:ITU</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">qb:slice</span><span class="c011">      </span><span class="c011">:ITU09B</span><span class="c011"> </span><span class="c011">,</span><span class="c011">
</span><span class="c011">               </span><span class="c011">:ITU10B,</span><span class="c011">
</span><span class="c011">               ...</span><span class="c011">
</span><span class="c011">:ITU09B</span><span class="c011"> </span><span class="c011">a</span><span class="c011">          </span><span class="c011">qb:Slice</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">qb:sliceStructure</span><span class="c011"> </span><span class="c011">wf:sliceByArea</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">qb:observation</span><span class="c011">    </span><span class="c011">:obs8165,</span><span class="c011">
</span><span class="c011">                   </span><span class="c011">:obs8166,</span><span class="c011">
</span><span class="c011">                   ...</span><span class="c011">
</span><span class="c011">:ITU</span><span class="c011"> </span><span class="c011">a</span><span class="c011">         </span><span class="c011">org:Organization</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">rdfs:label</span><span class="c011">    </span><span class="c011"><span class="c011">"ITU"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">foaf:homepage</span><span class="c011"> &lt;</span><span class="c011">http:</span><span class="c011">//</span><span class="c011">www</span><span class="c011">.</span><span class="c011">itu</span><span class="c011">.</span><span class="c011">int</span><span class="c011">/&gt; .</span><span class="c011">
</span><span class="c011">
</span><span class="c011">:Spain</span><span class="c011">
</span><span class="c011"> </span><span class="c011">wf:iso2</span><span class="c011">    </span><span class="c011"><span class="c011">"ES"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">rdfs:label</span><span class="c011"> </span><span class="c011"><span class="c011">"Spain"</span></span><span class="c011"> .</span><span class="c011">
</span><span class="c011">
</span><span class="c011">:ITU_B</span><span class="c011"> </span><span class="c011">a</span><span class="c011">     </span><span class="c011">wf:SecondaryIndicator</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">rdfs:label</span><span class="c011">  </span><span class="c011"><span class="c011">"Broadband subscribers percent"</span></span><span class="c011">;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">wf:provider</span><span class="c011"> </span><span class="c011">:ITU</span><span class="c011"> .</span></td></tr>
</table><p>For verification, the WebIndex data model includes a representation of computations that declare how each observation has been obtained, either from a raw dataset or computed from the observations of other datasets. 
The structure of computation descriptions, presented in [<a href="bookHtml019.html#LabraMTSR14">56</a>], is omitted here for simplicity.</p><p>In the next section we formally define the structure of this simplified WebIndex data model using ShEx 
and review the main differences with the original.</p>
<h3 class="subsection" id="sec176">6.1.1  WebIndex in ShEx</h3>
<p> 
<a id="ch070WebIndexShEx"></a>
<a id="ch6.sec1.1"></a></p><p>The following declaration indicates that a valid 
<code>:Country</code> shape must have exactly one

<code>rdfs:label</code> and exactly one 
<code>wf:iso2</code> both of which must be literals 
of type 
<code>xsd:string</code>. In the case of 
<code>wf:iso2</code> it must also have length 2.</p><p><a id="ShExCountry"></a>

</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011"><span class="c006">:Country</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">rdfs:label</span></span><span class="c011"> </span><span class="c011"><span class="c006">xsd:string</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">wf:iso2</span></span><span class="c011">    </span><span class="c011"><span class="c006">xsd:string</span></span><span class="c011"> </span><span class="c011"><span class="c006">LENGTH</span></span><span class="c011"> 2</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>In this example, we deliberately omitted the requirement for a 
<code>rdf:type</code> declaration.
This means that, in order to satisfy the 
<code>:Country</code> shape, 
a node need only have the properties that have been specified and may or may not include 
<code>rdf:type</code> declarations.</p><p>By default, shape definitions are <em>open</em>
meaning that additional triples with different predicates may be present,
so nodes of shape 
<code>:Country</code> could have other properties beyond those
prescribed by the shape.</p><p>The shape of datasets is described as follows:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011"><span class="c006">:DataSet</span></span><span class="c011"> { </span><span class="c011"><span class="c006">a</span></span><span class="c011">   [ </span><span class="c011"><span class="c006">qb:DataSet</span></span><span class="c011"> ]</span><span class="c011"><span class="c006">,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">qb:structure</span></span><span class="c011">  [ </span><span class="c011"><span class="c006">wf:DSD</span></span><span class="c011"> ]</span><span class="c011"><span class="c006">,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">rdfs:label</span></span><span class="c011">    </span><span class="c011"><span class="c006">xsd:string</span></span><span class="c011"> ?</span><span class="c011"><span class="c006">,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">qb:slice</span></span><span class="c011">      </span><span class="c011"><span class="c006">@:Slice</span></span><span class="c011"> +</span><span class="c011"><span class="c006">,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">dct:publisher</span></span><span class="c011"> </span><span class="c011"><span class="c006">@:Organization</span></span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>This says that nodes conforming to 
<code>:DataSet</code> shape must have 
<code>rdf:type</code> with value 
<code>qb:DataSet</code>,
a 
<code>qb:structure</code> of 
<code>wf:DSD</code>, 
an optional 
<code>rdfs:label</code>
of type 
<code>xsd:string</code>, 
one or more 
<code>qb:slice</code> predicates whose object is the subject of a set of triples 
matching the 
<code>:Slice</code> shape definition and exactly one 
<code>dct:publisher</code>, 
whose object is the subject of a set of triples matching the 
<code>:Organization</code> shape.</p><p>The 
<code>:Slice</code> shape is defined in a similar fashion:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011"><span class="c006">:Slice</span></span><span class="c011"> { </span><span class="c011"><span class="c006">a</span></span><span class="c011">         [ </span><span class="c011"><span class="c006">qb:Slice</span></span><span class="c011"> ]</span><span class="c011"><span class="c006">,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">qb:sliceStructure</span></span><span class="c011"> [ </span><span class="c011"><span class="c006">wf:sliceByYear</span></span><span class="c011"> ]</span><span class="c011"><span class="c006">,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">qb:observation</span></span><span class="c011">    </span><span class="c011"><span class="c006">@:Observation</span></span><span class="c011">+</span><span class="c011"><span class="c006">,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">cex:indicator</span></span><span class="c011">     </span><span class="c011"><span class="c006">@:Indicator</span></span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>The 
<code>:Observation</code> shape in the WebIndex data model has two 
<code>rdf:type</code> declarations, which indicate that 
they must be instances of both the RDF Data Cube class of Observation (
<code>qb:Observation</code>) and the

<code>wf:Observation</code> class from the Web Foundation ontology.
The property 
<code>dct:publisher</code> is optional, but if it appears, it must have value 
<code>wf:WebFoundation</code>.</p><p>Values conforming to 
<code>:Observation</code> shape can either have a 
<code>wf:source</code> property of type 
<code>IRI</code> (which, in this context, is used to indicate that it is a raw observation that has been taken from the source represented by the IRI), 
or a 
<code>cex:computation</code> property whose value conforms to the 
<code>:Computation</code> shape.</p><p>It should be noted that shapes do not define the semantics of an RDF graph. 
While the designers of the WebIndex dataset model have determined that a raw observation would be indicated using the 
<code>wf:source</code> predicate and with the object 
<code>IRI</code> referencing the original source, 
ShEx simply states that, in order for a subject to satisfy the 
<code>:Observation</code>, it must include either a 
<code>wf:source</code> or a 
<code>cex:computation</code> predicate, period. 
Meaning must be found elsewhere.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011"><span class="c006">:Observation</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">a</span></span><span class="c011">                 [ </span><span class="c011"><span class="c006">qb:Observation</span></span><span class="c011"> ]</span><span class="c011"><span class="c006">,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">a</span></span><span class="c011">                 [ </span><span class="c011"><span class="c006">wi:Observation</span></span><span class="c011"> ]</span><span class="c011"><span class="c006">,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">cex:value</span></span><span class="c011">         </span><span class="c011"><span class="c006">xsd:float,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">dct:issued</span></span><span class="c011">        </span><span class="c011"><span class="c006">xsd:dateTime,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">dct:publisher</span></span><span class="c011">     [</span><span class="c011"><span class="c006">wf:WebFoundation</span></span><span class="c011">]?</span><span class="c011"><span class="c006">,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">qb:dataSet</span></span><span class="c011">        </span><span class="c011"><span class="c006">@:DataSet,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">cex:ref</span></span><span class="c011">-</span><span class="c011"><span class="c006">area</span></span><span class="c011">      </span><span class="c011"><span class="c006">@:Country,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">cex:indicator</span></span><span class="c011">     </span><span class="c011"><span class="c006">@:Indicator,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">cex:ref</span></span><span class="c011">-</span><span class="c011"><span class="c006">year</span></span><span class="c011">      </span><span class="c011"><span class="c006">xsd:gYear,</span></span><span class="c011">
</span><span class="c011"> ( </span><span class="c011"><span class="c006">wf:source</span></span><span class="c011">       </span><span class="c011"><span class="c006">IRI</span></span><span class="c011">
</span><span class="c011"> | </span><span class="c011"><span class="c006">cex:computation</span></span><span class="c011"> </span><span class="c011"><span class="c006">@:Computation</span></span><span class="c011">
</span><span class="c011"> )</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>A computation is represented as a node with type 
<code>cex:Computation</code>.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011"><span class="c006">:Computation</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">a</span></span><span class="c011"> [ </span><span class="c011"><span class="c006">cex:Computation</span></span><span class="c011"> ]</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>The type of indicators must be either 
<code>wf:PrimaryIndicator</code> or 

<code>wf:SecondaryIndicator</code>. 
They must also contain the property 
<code>wf:provider</code> with a value conforming to shape 
<code>:Organization</code>.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011"><span class="c006">:Indicator</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">a</span></span><span class="c011">           [ </span><span class="c011"><span class="c006">wf:PrimaryIndicator</span></span><span class="c011">
</span><span class="c011">               </span><span class="c011"><span class="c006">wf:SecondaryIndicator</span></span><span class="c011">
</span><span class="c011">             ]</span><span class="c011"><span class="c006">,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">wf:provider</span></span><span class="c011"> </span><span class="c011"><span class="c006">@:Organization</span></span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>In the case of organizations, we declare these as closed shapes using the 
<code>CLOSED</code> modifier and only allow the properties 
<code>rdfs:label</code>, 
<code>foaf:homepage</code> and 
<code>rdf:type</code>, which must have the value 
<code>org:Organization</code>.
The 
<code>EXTRA</code> modifier is used to declare that we allow other values for the 
<code>rdf:type</code> property (using the Turtle keyword 
<code>a</code>).</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011"><span class="c006">:Organization</span></span><span class="c011"> </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> </span><span class="c011"><span class="c006">EXTRA</span></span><span class="c011"> </span><span class="c011"><span class="c006">a</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">a</span></span><span class="c011">             [ </span><span class="c011"><span class="c006">org:Organization</span></span><span class="c011"> ]</span><span class="c011"><span class="c006">,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">rdfs:label</span></span><span class="c011">    </span><span class="c011"><span class="c006">xsd:string,</span></span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">foaf:homepage</span></span><span class="c011"> </span><span class="c011"><span class="c006">IRI</span></span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>Shape Expressions offer an intuitive way to describe the contents of linked data portals.
They have been used to document both the WebIndex<sup><a id="text42" href="#note42">1</a></sup> and 
another data portal with a similar model, the Landbook<sup><a id="text43" href="#note43">2</a></sup> data portal.
Their documentation defines templates for the different shapes of resources and for the triples that can be retrieved when dereferencing those resources. 
These templates define the dataset structure in a declarative way and can serve as a contract between developers of the data portal contents and designers of the data model. 
Having a good data model with a corresponding Shape Expressions specification facilitated the communication between the various stakeholders involved.</p><p>The data model described in this chapter differs from the original one for readability and didactic proposes in the following ways:</p><ul class="itemize"><li class="li-itemize">
We omitted the representation of computations, which are represented as single nodes with type 
<code>cex:Computation</code>. 
A more detailed description of computations was described at [<a href="bookHtml019.html#LabraMTSR14">56</a>].
We have also simplified the representation of the webindex structure,
which was composed of sub-indexes, components and other properties such as labels and provenance information.</li><li class="li-itemize">We defined the shapes of countries to include just two simple properties.
We deliberately omit the mandatory use of 
<code>rdf:type</code> declaration to show that 
it is possible to have nodes without that declaration. 
In the original WebIndex data model all countries had a mandatory 
<code>rdf:type</code> arc but there were several generated nodes 
which did not have 
<code>rdf:type</code> declarations. 
As we omitted the representation of computations we decided to offer that possibility for countries as an example. </li></ul><p>Appendix <a href="bookHtml015.html#AppendixWebIndexShEx">A</a> includes the full version of the WebIndex ShEx description used in this book. </p>
<h3 class="subsection" id="sec177">6.1.2  WebIndex in SHACL</h3>
<p> 
<a id="ch070WebIndexSHACL"></a>
<a id="ch6.sec1.2"></a></p><p>Although the original data portal was modeled in ShEx, 
we undertook the exercise of defining a SHACL description for the same contents so that we could compare the expressiveness of ShEx and SHACL. 
In this section we present a possible encoding in SHACL.</p><p>An equivalent description in SHACL of the 
<code>:Country</code> shape defined on 
page <a href="#ShExCountry">??</a> would be:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:Country</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdfs:label</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:datatype</span><span class="c011"> </span><span class="c011">xsd:string</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:minCount</span><span class="c011"> 1; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">wf:iso2</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:datatype</span><span class="c011"> </span><span class="c011">xsd:string</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:length</span><span class="c011"> 2 ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:minCount</span><span class="c011"> 1; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">] .</span></td></tr>
</table><p>As can be seen, the 
<code>:Country</code> shape is defined by two constraints which specify that the datatype of 
<code>rdfs:label</code> and 
<code>wf:iso2</code> properties must be 
<code>xsd:string</code> and that 
<code>wf:iso2</code> has length 2.</p><p><a id="hevea_default774"></a>
<a id="hevea_default775"></a>
<a id="hevea_default776"></a>
The default SHACL cardinality constraint is 
<code>[0..*]</code> meaning that cardinality constraints that are omitted in ShEx grammar must be explicitly stated in SHACL as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">sh:minCount</span><span class="c011"> 1; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span></td></tr>
</table><p>Optionality (
<code>?</code> or 
<code>*</code> in ShEx) can be represented either by omitting 
<code>sh:minCount</code> or by 
<code>sh:minCount</code><code>=0</code>. 
An unbounded maximum cardinality (
<code>*</code> or 
<code>+</code> in ShEx) must be represented in SHACL by omitting 
<code>sh:maxCount</code>.
As an example, the definition of the 
<code>:DataSet</code> shape declares that 
<code>rdfs:label</code> is optional (by omitting the 
<code>sh:minCount</code> property) and declares that there must be one or more 
<code>qb:slice</code> predicates conforming to the 
<code>qb:slice</code> definition (by omitting the value of 
<code>sh:maxCount</code>).</p><p><a id="hevea_default777"></a>
The predicate 
<code>sh:node</code> is used to indicate that the value of a property must have a given shape. 
In this way, a shape can refer to another shape. 
Note that the WebIndex data model contains cycles—shapes refer to other shapes and those shapes can refer back to the first ones—which can generate recursive shapes. 
Nevertheless, the handling of recursion in SHACL is implementation-dependent so it is necessary to circumvent this feature following some of the techniques shown in section <a href="bookHtml012.html#050SHACLRecursion">5.12.1</a>).</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:DataSet</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdf:type</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:hasValue</span><span class="c011"> </span><span class="c011">qb:DataSet</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:minCount</span><span class="c011"> 1; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">qb:structure</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:hasValue</span><span class="c011"> </span><span class="c011">wf:DSD</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:minCount</span><span class="c011"> 1; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdfs:label</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:datatype</span><span class="c011"> </span><span class="c011">xsd:string</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">qb:slice</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:node</span><span class="c011">     </span><span class="c011">:Slice</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:minCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dct:publisher</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:Organization</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:minCount</span><span class="c011"> 1; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011"> ] .</span></td></tr>
</table><p>The definition of 
<code>:Slice</code> is similar to 
<code>:DataSet</code>, so we can omit it for clarity. 
The full version of the SHACL shapes that we used in this section is shown in appendix <a href="bookHtml016.html#AppendixWebIndexSHACL">B</a>.</p><p>There are three items that need more explanation in the SHACL definition of the 
<code>:Observation</code> shape. 
The first of these is the repeated appearance of the 
<code>rdf:type</code> property with two values.
Although we initially represented it using qualified value shapes, we noticed that it could also be 
represented as: </p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:Observation</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdf:type</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:in</span><span class="c011"> ( </span><span class="c011">qb:Observation</span><span class="c011"> </span><span class="c011">wf:Observation</span><span class="c011"> )</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdf:type</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:minCount</span><span class="c011"> 2; </span><span class="c011">sh:maxCount</span><span class="c011"> 2</span><span class="c011">
</span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">...</span></td></tr>
</table><p>The definition of observations also contains an optional property with a fixed value. This was defined in ShEx as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011"><span class="c006">:Observation</span></span><span class="c011"> {  ...</span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">dct:publisher</span></span><span class="c011"> (</span><span class="c011"><span class="c006">wf:WebFoundation</span></span><span class="c011">)?</span><span class="c011">
</span><span class="c011"> ...</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>which means that observations can either have a property 
<code>dct:publisher</code> with the fixed 
value 
<code>wf:WebFoundation</code> or they can not have that property. </p><p>A possible representation in SHACL is to use an 
<code>sh:or</code> of two shapes: 
one in which there is no 
<code>dct:publisher</code> (
<code>sh:maxCount</code>=0) and one with exactly one value for 
<code>dct:published</code>. </p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:Observation</span><span class="c011">  ...</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:or</span><span class="c011"> ( [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dct:publisher</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">           </span><span class="c011">sh:maxCount</span><span class="c011"> 0</span><span class="c011">
</span><span class="c011">         ]</span><span class="c011">
</span><span class="c011">         [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dct:publisher</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">           </span><span class="c011">sh:hasValue</span><span class="c011"> </span><span class="c011">wf:WebFoundation</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">           </span><span class="c011">sh:minCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">           </span><span class="c011">sh:maxCount</span><span class="c011"> 1</span><span class="c011">
</span><span class="c011">         ]</span><span class="c011">
</span><span class="c011"> )</span><span class="c011">
</span><span class="c011"> ...</span></td></tr>
</table><p>The last item requiring additional explanation is the disjunction definition which says that observations 
must have either the property 
<code>cex:computation</code> with a value of shape 
<code>:Computation</code> or the property 
<code>wf:source</code> with an IRI value, but not both.
In ShEx, it was defined as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011"><span class="c006">:Observation</span></span><span class="c011"> { ...</span><span class="c011">
</span><span class="c011"> </span><span class="c011"><span class="c006">,</span></span><span class="c011"> ( </span><span class="c011"><span class="c006">cex:computation</span></span><span class="c011"> </span><span class="c011"><span class="c006">@:Computation</span></span><span class="c011">
</span><span class="c011">   | </span><span class="c011"><span class="c006">wf:source</span></span><span class="c011"> </span><span class="c011"><span class="c006">IRI</span></span><span class="c011">
</span><span class="c011">   )</span><span class="c011">
</span><span class="c011"> ...</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>In SHACL, this declaration can be defined using the 
<code>sh:xone</code> (exactly one) property constraint:</p><p><a id="DisjointOrShacl"></a>


</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:Observation</span><span class="c011">
</span><span class="c011"> ...</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:xone</span><span class="c011"> ( [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">wf:source</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">             </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">             </span><span class="c011">sh:minCount</span><span class="c011"> 1; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">           ]</span><span class="c011">
</span><span class="c011">           [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">cex:computation</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">             </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:Computation</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">             </span><span class="c011">sh:minCount</span><span class="c011"> 1; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">           ]</span><span class="c011">
</span><span class="c011"> )</span><span class="c011">
</span><span class="c011">...</span></td></tr>
</table><p>In the case of indicators we can see again the separation between the 
<code>:Indicator</code> shape and 
the 
<code>wf:PrimaryIndicator</code> and 
<code>wf:SecondaryIndicator</code> classes.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:Indicator</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdf:type</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:in</span><span class="c011"> ( </span><span class="c011">wf:PrimaryIndicator</span><span class="c011"> </span><span class="c011">wf:SecondaryIndicator</span><span class="c011"> ) ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:minCount</span><span class="c011"> 1; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> ...</span></td></tr>
</table><p>We defined organizations as closed shapes with the possibility that the 
<code>rdf:type</code> property has some extra values apart from the 
<code>org:Organization</code>. 
This constraint can be expressed in SHACL as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:Organization</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:closed</span><span class="c011"> </span><span class="c011">true</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:ignoredProperties</span><span class="c011"> ( </span><span class="c011">rdf:type</span><span class="c011"> )</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdf:type</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:hasValue</span><span class="c011"> </span><span class="c011">org:Organization</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  ] ;</span><span class="c011">
</span><span class="c011"> ...</span></td></tr>
</table><p>An important aspect that deserves some explanation is the use of recursion to represent cyclic data models. 
While ShEx can define cyclic data models in a natural way, the lack of recursion in SHACL needs to be circumvented.</p><p>One possibility is to add a discriminating 
<code>rdf:type</code> arc to every node so that its shape can be associated to its class. 
We opted to add a 
<code>sh:targetClass</code> declaration to some shapes, such as 
<code>:Observation</code>, conflating that shape 
with the class 
<code>qb:Observation</code>. Any node that contains a 
<code>rdf:type</code> arc pointing to 
<code>qb:Observation</code> must conform 
to the 
<code>:Observation</code> shape declared by the WebIndex.</p><p>While this approach may be reasonable in closed contexts, it can cause problems in the open semantic web if one combines data from other datasets. 
For example, we defined another data model based on RDF data cube for the LandPortal project<sup><a id="text44" href="#note44">3</a></sup> 
which also contained values of type 
<code>qb:Observation</code> but with different structures. 
We consider that forcing every node of type 
<code>qb:Observation</code> to have the same structure is not a good practice and that it may be better to separate the target declarations from the shapes definitions.</p><p><a id="hevea_default778"></a>
</p>
<h2 class="section" id="sec178">6.2  Describing Clinical Records—FHIR</h2>
<p> 
<a id="ch060FHIR"></a>
<a id="ch6.sec2"></a></p><p><a id="hevea_default779"></a>
<a id="hevea_default780"></a> <a id="hevea_default781"></a>
<a id="hevea_default782"></a></p><p>Fast Healthcase Interoperability Resources 
(FHIR)<sup><a id="text45" href="#note45">4</a></sup> is a framework created by HL7,
a clinical standards organization, to define data formats and APIs for exchanging electronic health records. 
FHIR Release 3.0 was published in March 2017 and adds support for RDF.</p><p><a id="hevea_default783"></a> <a id="hevea_default784"></a> <a id="hevea_default785"></a>
FHIR has a resource-oriented architecture that describes the different entities involved in a clinical record. 
In a typical example, a patient (
<code>Patient</code> resource) visits a clinician (
<code>Practitioner</code> resource), who records some observations (
<code>Observation</code> resource), reviews some lab results (
<code>Diagnostic</code> results probably referencing other observations) and diagnoses a clinical issue (
<code>Condition</code> resource). 
These resources can be expressed interchangeably in multiple formats:
JSON, XML, and RDF.</p><p><a id="hevea_default786"></a> <a id="hevea_default787"></a> <a id="hevea_default788"></a>
FHIR resources are described by structure definitions in a FHIR-specific
schema language. 
This machine-readable language is translated into format-specific schema languages such as XML Schema plus Schematron, JSON Schema, and ShEx.</p><p>The structure of FHIR resources is documented as machine-generated HTML tables. 
Figure <a href="#ch070.ObservationFHIR">6.2</a> shows part of the FHIR 
<code>Observation</code> resource<sup><a id="text46" href="#note46">5</a></sup>.</p><p>FHIR structure definitions have two forms of limited disjunction.
The first, choices of the types of referenced resources, can be seen in 
<code>subject</code> and 
<code>performer</code> in Figure <a href="#ch070.ObservationFHIR">6.2</a>.
The second is a choice between a set of datatypes where the name of the datatype is appended to the property name, indicated by the 
<code>[</code><code>x</code><code>]</code> notation 
(see 
<code>effective</code><code>[</code><code>x</code><code>]</code> and 
<code>value</code><code>[</code><code>x</code><code>]</code> in Figure <a href="#ch070.ObservationFHIR">6.2</a>).
These are captured in ShEx using the shape expression ShapeOr (’
<code>OR</code>’) and the triple expression OneOf (’
<code>|</code>’) respectively:</p><div class="example"><div class="theorem"><span class="c013">Example 156</span>  <em>FHIR Observation representation in ShEx</em><em>
</em><em>
</em><table class="lstframe c014"><tr><td class="lstlisting"><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">Observation</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">CLOSED</span></span></em><em><span class="c011"> { </span></em><em><span class="c011"><span class="c006">a</span></span></em><em><span class="c011"> [</span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">];</span></em><em><span class="c011">
</span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">obs:status</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">code</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011"> {</span></em><em><span class="c011"><span class="c006">fhir:value</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@fhirvs:observation</span></span></em><em><span class="c011">-</span></em><em><span class="c011"><span class="c006">status</span></span></em><em><span class="c011">};</span></em><em><span class="c011">
</span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">obs:code</span></span></em><em><span class="c011">   </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">CodeableConcept</span></span></em><em><span class="c011">&gt;;</span></em><em><span class="c011">
</span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">obs:subject</span></span></em><em><span class="c011">
</span></em><em><span class="c011">    (   </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">PatientReference</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">OR</span></span></em><em><span class="c011">
</span></em><em><span class="c011">        </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">GroupReference</span></span></em><em><span class="c011">&gt;   </span></em><em><span class="c011"><span class="c006">OR</span></span></em><em><span class="c011">
</span></em><em><span class="c011">        </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">DeviceReference</span></span></em><em><span class="c011">&gt;  </span></em><em><span class="c011"><span class="c006">OR</span></span></em><em><span class="c011">
</span></em><em><span class="c011">        </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">LocationReference</span></span></em><em><span class="c011">&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011">    )?;</span></em><em><span class="c011">
</span></em><em><span class="c011">    (   </span></em><em><span class="c011"><span class="c006">obs:effectiveDateTime</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">dateTime</span></span></em><em><span class="c011">&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011">     |  </span></em><em><span class="c011"><span class="c006">obs:effectiveTiming</span></span></em><em><span class="c011">   </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">Timing</span></span></em><em><span class="c011">&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011">    )?;</span></em><em><span class="c011">
</span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">obs:issued</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">instant</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">obs:performer</span></span></em><em><span class="c011">
</span></em><em><span class="c011">    (   </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">PractitionerReference</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">OR</span></span></em><em><span class="c011">
</span></em><em><span class="c011">        </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">OrganizationReference</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">OR</span></span></em><em><span class="c011">
</span></em><em><span class="c011">        </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">PatientReference</span></span></em><em><span class="c011">&gt;      </span></em><em><span class="c011"><span class="c006">OR</span></span></em><em><span class="c011">
</span></em><em><span class="c011">        </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">RelatedPersonReference</span></span></em><em><span class="c011">&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011">    )*;</span></em><em><span class="c011">
</span></em><em><span class="c011">    (   </span></em><em><span class="c011"><span class="c006">obs:valueQuantity</span></span></em><em><span class="c011">        </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">Quantity</span></span></em><em><span class="c011">&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011">     |  </span></em><em><span class="c011"><span class="c006">obs:valueCodeableConcept</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">CodeableConcept</span></span></em><em><span class="c011">&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011">     |  </span></em><em><span class="c011"><span class="c006">obs:valueDateTime</span></span></em><em><span class="c011">        </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">dateTime</span></span></em><em><span class="c011">&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011">     |  </span></em><em><span class="c011"><span class="c006">obs:valuePeriod</span></span></em><em><span class="c011">          </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">Period</span></span></em><em><span class="c011">&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011">    )?;</span></em><em><span class="c011">
</span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">obs:bodySite</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">CodeableConcept</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">}</span></em><em><span class="c011">
</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">fhirvs:observation</span></span></em><em><span class="c011">-</span></em><em><span class="c011"><span class="c006">status</span></span></em><em><span class="c011"> [</span></em><em><span class="c011"><span class="c006"><em><span class="c011">"registered"</span></em></span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006"><em><span class="c011">"preliminary"</span></em></span></span></em><em><span class="c011">
</span></em><em><span class="c011">                           </span></em><em><span class="c011"><span class="c006"><em><span class="c011">"final"</span></em></span></span></em><em><span class="c011">      </span></em><em><span class="c011"><span class="c006"><em><span class="c011">"amended"</span></em></span></span></em><em><span class="c011"> ]</span></em></td></tr>
</table></div></div><blockquote class="figure"><div class="center"><hr class="c021"></div> 
<div class="center">
<img src="Observation-cut3.eps.png">
</div>

<a id="ch070.ObservationFHIR"></a>
<div class="caption"><table class="c002 cellpading0"><tr><td class="c018">Figure 6.2: Part of Observation resource in FHIR.</td></tr>
</table></div>
<div class="center"><hr class="c021"></div></blockquote>
<h3 class="subsection" id="sec179">6.2.1  FHIR as Linked Data</h3>
<p>
<a id="ch6.sec2.2"></a></p><p>The definition of the RDF representation of FHIR was greatly simplified because FHIR was designed to be resource-oriented.
While clinical records are not expected to end up on the web, 
the REST architecture was an easy way to implement addressability and separation of concerns.</p><p>This means that FHIR resources are interlinked in a fashion that is already familiar to users of Linked Data.
For example, the 
<code>Observation</code> excerpt includes references for the 
<code>subject</code> and 
<code>performer</code>.
The 
<code>subject</code> may be a resource of type

<code>Patient</code>, 
<code>Group</code>, 
<code>Device</code> or 
<code>Location</code>, and the 
<code>performer</code> may be a 
<code>Practitioner</code>, 
<code>Organization</code>, 
<code>Patient</code>, or a 
<code>RelatedPerson</code> (see Figure <a href="#ch070.ObservationFHIR">6.2</a>).
While Linked Data is most commonly associated with RDF, these constraints apply equally to the XML and JSON representations of FHIR.
However, of the four schema languages used to validate FHIR, only ShEx validation spans resources.</p><p>There are several reasons why one might want to limit validation to a single document: 
other resources might not be available or relevant and 
it may be impractical either computationally or procedurally to test conformance of many resources at once.
However, a common use case for Linked Data is that all related data is addressable and available. 
Extending our schema to include verification of external referents allows us to ensure that a resource is coherent not only on its own but also when used in the context of the resources to which it is linked. </p>
<h3 class="subsection" id="sec180">6.2.2  Consistency constraints</h3>
<p>
<a id="ch6.sec2.1"></a></p><p><a id="hevea_default789"></a> <a id="hevea_default790"></a>
The FHIR-specific schemas are expressed as combinations of structure definitions describing types and containership, and constraints.
Most constraints are co-existence constraints, e.g., 
if there is a 
<code>duration</code> there must be a 
<code>durationUnits</code>.
For XML, structure definitions are expressed as XML Schema, and co-existence constraints are expressed, where possible, in Schematron. 
For RDF, structure definitions and coexistence constraints are both expressed in ShEx.</p><p>An example with co-existence constraints is the representation of the 
<code>Timing</code> datatype, which represents an event that may occur multiple times. 
A Timing schedule can be a list of events and/or criteria for when the event happens, 
which can be expressed in a structured form and/or as a code. Figure <a href="#ch070.TimingFHIRDSL">6.2.2</a> shows the HTML representation of 
<code>Timing</code>.</p><blockquote class="figure"><div class="center"><hr class="c021"></div> 
<div class="center">
<img src="ch06-02.png">
</div>

<a id="ch070.TimingFHIRDSL"></a>
<div class="caption"><table class="c002 cellpading0"><tr><td class="c018">Figure 6.3: Complete Timing datatype in FHIR.</td></tr>
</table></div>
<div class="center"><hr class="c021"></div></blockquote><p><a id="hevea_default791"></a> <a id="hevea_default792"></a> <a id="hevea_default793"></a> <a id="hevea_default794"></a> 
While these human-friendly HTML representations are generated from the FHIR schema,
they could easily be generated from representations in other schema languages such as XML Schema, ShEx or SHACL. 
Schemas using more expressivity may be difficult to convey graphically to users. 
For instance, these property trees do not have a way to assert co-existence constraints, e.g. that certain properties are mutually exclusive.
<a id="hevea_default795"></a> <a id="hevea_default796"></a>
In a UML stack, these sorts of constraints would be expressed using OCL (see section <a href="bookHtml010.html#ch3.sec1.1">3.1.1</a>).</p><div class="example"><div class="theorem"><span class="c013">Example 157</span>  <em>Timing representation in ShEx</em><sup><a id="text47" href="#note47"><em>6</em></a></sup><p><em>The ShEx representation of </em><em>
</em><code><em>Timing</em></code><em> is defined as:</em></p><table class="lstframe c014"><tr><td class="lstlisting"><em><span class="c011"><span class="c006">PREFIX</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">:</span></span></em><em><span class="c011">       &lt;</span></em><em><span class="c011"><span class="c006">http:</span></span></em><em><span class="c011">//</span></em><em><span class="c011"><span class="c006">hl7</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">org</span></span></em><em><span class="c011">/</span></em><em><span class="c011"><span class="c006">fhir</span></span></em><em><span class="c011">/</span></em><em><span class="c011"><span class="c006">Timing</span></span></em><em><span class="c011">.&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">PREFIX</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">fhirvs:</span></span></em><em><span class="c011"> &lt;</span></em><em><span class="c011"><span class="c006">http:</span></span></em><em><span class="c011">//</span></em><em><span class="c011"><span class="c006">hl7</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">org</span></span></em><em><span class="c011">/</span></em><em><span class="c011"><span class="c006">fhir</span></span></em><em><span class="c011">/</span></em><em><span class="c011"><span class="c006">ValueSet</span></span></em><em><span class="c011">/&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">BASE</span></span></em><em><span class="c011">   &lt;</span></em><em><span class="c011"><span class="c006">http:</span></span></em><em><span class="c011">//</span></em><em><span class="c011"><span class="c006">hl7</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">org</span></span></em><em><span class="c011">/</span></em><em><span class="c011"><span class="c006">fhir</span></span></em><em><span class="c011">/</span></em><em><span class="c011"><span class="c006">shape</span></span></em><em><span class="c011">/&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011">
</span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">Timing</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">CLOSED</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:event</span></span></em><em><span class="c011">              </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">dateTime</span></span></em><em><span class="c011">&gt;*;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">             </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">Timing</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">repeat</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:code</span></span></em><em><span class="c011">               </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">CodeableConcept</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">}</span></em></td></tr>
</table><p><em>where </em><em>
</em><code><em>Timing</em></code><code><em>.</em></code><code><em>repeat</em></code><em> shape contains two parts: a structure definition (lines 1–24) and several co-existence constraints (lines 25–35) which can be expressed in natural language as:</em></p><ul class="itemize"><li class="li-itemize"><em>
</em><em>If there is a </em><em>
</em><code><em>duration</em></code><em>, there needs to be </em><em>
</em><code><em>durationUnits</em></code><em>.
</em></li><li class="li-itemize"><em>If there’s a </em><em>
</em><code><em>period</em></code><em>, there needs to be </em><em>
</em><code><em>periodUnits</em></code><em>.
</em></li><li class="li-itemize"><em>
</em><code><em>duration</em></code><em> shall be a non-negative value.
</em></li><li class="li-itemize"><em>
</em><code><em>period</em></code><em> shall be a non-negative value. 
</em></li><li class="li-itemize"><em>If there is a </em><em>
</em><code><em>periodMax</em></code><em>, there must be a </em><em>
</em><code><em>period</em></code><em>. 
</em></li><li class="li-itemize"><em>If there is a </em><em>
</em><code><em>durationMax</em></code><em>, there must be a </em><em>
</em><code><em>duration</em></code><em>.
</em></li><li class="li-itemize"><em>If there is a </em><em>
</em><code><em>countMax</em></code><em>, there must be a </em><em>
</em><code><em>count</em></code><em>.
</em></li><li class="li-itemize"><em>If there is an </em><em>
</em><code><em>offset</em></code><em>, there must be a </em><em>
</em><code><em>when</em></code><em> (and not </em><em>
</em><code><em>C</em></code><em>, </em><em>
</em><code><em>CM</em></code><em>, </em><em>
</em><code><em>CD</em></code><em>, </em><em>
</em><code><em>CV</em></code><em>).
</em></li><li class="li-itemize"><em>If there is a </em><em>
</em><code><em>timeOfDay</em></code><em>, there cannot be a when, or vice versa.
</em></li></ul><table class="lstframe c014"><tr><td class="lstlisting"><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">Timing</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">repeat</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">CLOSED</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">  ( </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">boundsDuration</span></span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">Duration</span></span></em><em><span class="c011">&gt; |</span></em><em><span class="c011">
</span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">boundsRange</span></span></em><em><span class="c011">     </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">Range</span></span></em><em><span class="c011">&gt;    |</span></em><em><span class="c011">
</span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">boundsPeriod</span></span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">Period</span></span></em><em><span class="c011">&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011">  )?;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">count</span></span></em><em><span class="c011">        </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">integer</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">countMax</span></span></em><em><span class="c011">     </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">integer</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">duration</span></span></em><em><span class="c011">     </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">decimal</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">durationMax</span></span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">decimal</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">durationUnit</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">code</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011">
</span></em><em><span class="c011">                       { </span></em><em><span class="c011"><span class="c006">fhir:value</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@fhirvs:units</span></span></em><em><span class="c011">-</span></em><em><span class="c011"><span class="c006">of</span></span></em><em><span class="c011">-</span></em><em><span class="c011"><span class="c006">time</span></span></em><em><span class="c011"> }?;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">frequency</span></span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">integer</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">frequencyMax</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">integer</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">period</span></span></em><em><span class="c011">       </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">decimal</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">periodMax</span></span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">decimal</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">periodUnit</span></span></em><em><span class="c011">   </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">code</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011">
</span></em><em><span class="c011">                       { </span></em><em><span class="c011"><span class="c006">fhir:value</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@fhirvs:units</span></span></em><em><span class="c011">-</span></em><em><span class="c011"><span class="c006">of</span></span></em><em><span class="c011">-</span></em><em><span class="c011"><span class="c006">time</span></span></em><em><span class="c011"> }?;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">dayOfWeek</span></span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">code</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011">
</span></em><em><span class="c011">                       { </span></em><em><span class="c011"><span class="c006">fhir:value</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@fhirvs:days</span></span></em><em><span class="c011">-</span></em><em><span class="c011"><span class="c006">of</span></span></em><em><span class="c011">-</span></em><em><span class="c011"><span class="c006">week</span></span></em><em><span class="c011"> }*;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">timeOfDay</span></span></em><em><span class="c011">    </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">time</span></span></em><em><span class="c011">&gt;*;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">when</span></span></em><em><span class="c011">         </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">code</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011">
</span></em><em><span class="c011">                       { </span></em><em><span class="c011"><span class="c006">fhir:value</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@fhirvs:event</span></span></em><em><span class="c011">-</span></em><em><span class="c011"><span class="c006">timing</span></span></em><em><span class="c011"> }*;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">offset</span></span></em><em><span class="c011">       </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">unsignedInt</span></span></em><em><span class="c011">&gt;?;</span></em><em><span class="c011">
</span></em><em><span class="c011">}</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011"> {(</span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">duration</span></span></em><em><span class="c011"> .; </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">durationUnits</span></span></em><em><span class="c011"> .)? }</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011"> {(</span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">period</span></span></em><em><span class="c011"> .  ; </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">periodUnits</span></span></em><em><span class="c011"> .)? }</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011"> {</span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">duration</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">MinInclusive</span></span></em><em><span class="c011"> 0 ? }</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011"> {</span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">period</span></span></em><em><span class="c011">   </span></em><em><span class="c011"><span class="c006">MinInclusive</span></span></em><em><span class="c011"> 0 ? }</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011"> {(</span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">periodMax</span></span></em><em><span class="c011">   . ; </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">period</span></span></em><em><span class="c011"> .  )? }</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011"> {(</span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">durationMax</span></span></em><em><span class="c011"> . ; </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">duration</span></span></em><em><span class="c011"> .)? }</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011"> {(</span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">countMax</span></span></em><em><span class="c011"> . ; </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">count</span></span></em><em><span class="c011"> .)? }</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011"> { </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">offset</span></span></em><em><span class="c011"> . ; </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">when</span></span></em><em><span class="c011"> [. - </span></em><em><span class="c011"><span class="c006"><em><span class="c011">"C"</span></em></span></span></em><em><span class="c011"> - </span></em><em><span class="c011"><span class="c006"><em><span class="c011">"CM"</span></em></span></span></em><em><span class="c011"> - </span></em><em><span class="c011"><span class="c006"><em><span class="c011">"CD"</span></em></span></span></em><em><span class="c011"> - </span></em><em><span class="c011"><span class="c006"><em><span class="c011">"CV"</span></em></span></span></em><em><span class="c011">]</span></em><em><span class="c011">
</span></em><em><span class="c011">    | </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">when</span></span></em><em><span class="c011"> . ? # </span></em><em><span class="c011"><span class="c006">if</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">there</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">is</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">no</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">offset</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">there</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">can</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">still</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">be</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">a</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">when</span></span></em><em><span class="c011">
</span></em><em><span class="c011">    }</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011"> {</span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">timeOfDay</span></span></em><em><span class="c011"> . | </span></em><em><span class="c011"><span class="c006">:repeat</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">when</span></span></em><em><span class="c011"> . }</span></em></td></tr>
</table></div></div><p>The value set idiom of specifying a value type and a value set (e.g., 
<code>&lt;</code><code>code</code><code>&gt;</code> and 
<code>fhirvs:units</code><code>-</code><code>of</code><code>-</code><code>time</code>) allows one to specify the structure and also to specify values within that structure.</p>
<h3 class="subsection" id="sec181">6.2.3  FHIR/RDF Development</h3>
<p>
<a id="ch6.sec2.3"></a>
<a id="ch070.FHIRRDFDevelopment"></a></p><p>The FHIR/RDF group, a joint undertaking of W3C and HL7, used ShEx not only to define the final product but also to describe intermediate ideas and test them against example data.
To this end, members of the group learned ShEx to streamline the process with concrete, testable proposals.
During the development and deployment of version 3 of FHIR, Harold Solbrig (Mayo Clinic) implemented a pipeline to test shapes against FHIR example data, catching errors in both the examples and the ShEx schema. </p><p>Because the agile FHIR standardization process is centered around the maintenance of FHIR resource structure definitions, 
the ShEx for FHIR is generated from these definitions. 
The easy way to do this is to generate ShExJ (the JSON representation) but because the FHIR group wanted these to be appealing to readers, 
they were transformed into ShExC, making specific white space decisions in the process. 
These ShExC representations could then be parsed to the abstract syntax to be tested against the reference ShExJ schemas. 
The latter transformation was simpler and less error prone as it is involved only with the direct semantics.</p>
<h3 class="subsection" id="sec182">6.2.4  Generic Properties</h3>
<p>
<a id="ch6.sec2.4"></a>
<a id="ch070.FHIRGenericProperties"></a></p><p>Because electronic medical records use a consistent template to represent most clinical data, they rely heavily on generic properties.
These properties may be used multiple times with different constraints.
A simple example of this is a blood pressure, which actually consists of two measurements: systolic (pressure during heart beat) and diastolic (pressure between heart beats).
Both of these measurements are connected to the blood pressure measurement by a 
<code>fhir:Observation</code><code>.</code><code>component</code> 
property.</p><div class="example"><div class="theorem"><span class="c013">Example 158</span>  <em>FHIR blood pressure</em><sup><a id="text48" href="#note48"><em>7</em></a></sup><p><em>A </em><em>
</em><code><em>&lt;</em></code><code><em>blood</em></code><code><em>-</em></code><code><em>pressure</em></code><code><em>&gt;</em></code><em> shape can be defined in ShEx as:</em></p><table class="lstframe c014"><tr><td class="lstlisting"><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">blood</span></span></em><em><span class="c011">-</span></em><em><span class="c011"><span class="c006">pressure</span></span></em><em><span class="c011">&gt; {</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">a</span></span></em><em><span class="c011"> [</span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">];</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">component</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">     </span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">component</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">code</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011"><span class="c006">fhir:CodeableConcept</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">coding</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">         </span></em><em><span class="c011"><span class="c006">a</span></span></em><em><span class="c011"> [</span></em><em><span class="c011"><span class="c006">loinc:8480</span></span></em><em><span class="c011">-6] ; # </span></em><em><span class="c011"><span class="c006">systolic</span></span></em><em><span class="c011">
</span></em><em><span class="c011">       }</span></em><em><span class="c011">
</span></em><em><span class="c011">     } ;</span></em><em><span class="c011">
</span></em><em><span class="c011">     </span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">component</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">valueQuantity</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011"><span class="c006">fhir:Quantity</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">value</span></span></em><em><span class="c011"> { </span></em><em><span class="c011"><span class="c006">fhir:value</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">xsd:decimal</span></span></em><em><span class="c011"> };</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011"><span class="c006">fhir:Quantity</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">unit</span></span></em><em><span class="c011"> { </span></em><em><span class="c011"><span class="c006">fhir:value</span></span></em><em><span class="c011"> [</span></em><em><span class="c011"><span class="c006"><em><span class="c011">"mmHg"</span></em></span></span></em><em><span class="c011">] };</span></em><em><span class="c011">
</span></em><em><span class="c011">     }</span></em><em><span class="c011">
</span></em><em><span class="c011">  } ;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">component</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">     </span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">component</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">code</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011"><span class="c006">fhir:CodeableConcept</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">coding</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">         </span></em><em><span class="c011"><span class="c006">a</span></span></em><em><span class="c011"> [</span></em><em><span class="c011"><span class="c006">loinc:8462</span></span></em><em><span class="c011">-4] ; # </span></em><em><span class="c011"><span class="c006">diastolic</span></span></em><em><span class="c011">
</span></em><em><span class="c011">       }</span></em><em><span class="c011">
</span></em><em><span class="c011">     };</span></em><em><span class="c011">
</span></em><em><span class="c011">     </span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">component</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">valueQuantity</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011"><span class="c006">fhir:Quantity</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">value</span></span></em><em><span class="c011"> { </span></em><em><span class="c011"><span class="c006">fhir:value</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">xsd:decimal</span></span></em><em><span class="c011"> };</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011"><span class="c006">fhir:Quantity</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">unit</span></span></em><em><span class="c011"> { </span></em><em><span class="c011"><span class="c006">fhir:value</span></span></em><em><span class="c011"> [</span></em><em><span class="c011"><span class="c006"><em><span class="c011">"mmHg"</span></em></span></span></em><em><span class="c011">] };</span></em><em><span class="c011">
</span></em><em><span class="c011">     }</span></em><em><span class="c011">
</span></em><em><span class="c011">  }</span></em><em><span class="c011">
</span></em><em><span class="c011">}</span></em></td></tr>
</table><p><em>and an example data conforming to that shape can be:</em></p><table class="lstframe c014"><tr><td class="lstlisting"><em><span class="c011">&lt;</span></em><em><span class="c011">http:</span></em><em><span class="c011">//</span></em><em><span class="c011">hl7</span></em><em><span class="c011">.</span></em><em><span class="c011">org</span></em><em><span class="c011">/</span></em><em><span class="c011">fhir</span></em><em><span class="c011">/</span></em><em><span class="c011">Observation</span></em><em><span class="c011">/</span></em><em><span class="c011">blood</span></em><em><span class="c011">-</span></em><em><span class="c011">pressure</span></em><em><span class="c011">&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011">a</span></em><em><span class="c011"> </span></em><em><span class="c011">fhir:Observation</span></em><em><span class="c011">;    </span></em><span class="c011"><em><span class="c011">#  \Passes{&lt;blood-pressure&gt;} *)</span></em></span><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011">fhir:Observation</span></em><em><span class="c011">.</span></em><em><span class="c011">component</span></em><em><span class="c011"> [</span></em><em><span class="c011">
</span></em><em><span class="c011">     </span></em><em><span class="c011">fhir:Observation</span></em><em><span class="c011">.</span></em><em><span class="c011">component</span></em><em><span class="c011">.</span></em><em><span class="c011">code</span></em><em><span class="c011"> [</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011">fhir:CodeableConcept</span></em><em><span class="c011">.</span></em><em><span class="c011">coding</span></em><em><span class="c011"> [</span></em><em><span class="c011">
</span></em><em><span class="c011">         </span></em><em><span class="c011">a</span></em><em><span class="c011"> </span></em><em><span class="c011">loinc:8480</span></em><em><span class="c011">-6; </span></em><span class="c011"><em><span class="c011"># systolic</span></em></span><em><span class="c011">
</span></em><em><span class="c011">       ]</span></em><em><span class="c011">
</span></em><em><span class="c011">     ];</span></em><em><span class="c011">
</span></em><em><span class="c011">     </span></em><em><span class="c011">fhir:Observation</span></em><em><span class="c011">.</span></em><em><span class="c011">component</span></em><em><span class="c011">.</span></em><em><span class="c011">valueQuantity</span></em><em><span class="c011"> [</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011">fhir:Quantity</span></em><em><span class="c011">.</span></em><em><span class="c011">value</span></em><em><span class="c011"> [ </span></em><em><span class="c011">fhir:value</span></em><em><span class="c011"> </span></em><em><span class="c011"><em><span class="c011">"107"</span></em></span></em><em><span class="c011">^^</span></em><em><span class="c011">xsd:decimal</span></em><em><span class="c011"> ];</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011">fhir:Quantity</span></em><em><span class="c011">.</span></em><em><span class="c011">unit</span></em><em><span class="c011"> [ </span></em><em><span class="c011">fhir:value</span></em><em><span class="c011"> </span></em><em><span class="c011"><em><span class="c011">"mmHg"</span></em></span></em><em><span class="c011"> ];</span></em><em><span class="c011">
</span></em><em><span class="c011">     ]</span></em><em><span class="c011">
</span></em><em><span class="c011">  ]</span></em><em><span class="c011">,</span></em><em><span class="c011"> [</span></em><em><span class="c011">
</span></em><em><span class="c011">     </span></em><em><span class="c011">fhir:Observation</span></em><em><span class="c011">.</span></em><em><span class="c011">component</span></em><em><span class="c011">.</span></em><em><span class="c011">code</span></em><em><span class="c011"> [</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011">fhir:CodeableConcept</span></em><em><span class="c011">.</span></em><em><span class="c011">coding</span></em><em><span class="c011"> [</span></em><em><span class="c011">
</span></em><em><span class="c011">         </span></em><em><span class="c011">a</span></em><em><span class="c011"> </span></em><em><span class="c011">loinc:8462</span></em><em><span class="c011">-4; </span></em><span class="c011"><em><span class="c011"># diastolic</span></em></span><em><span class="c011">
</span></em><em><span class="c011">       ]</span></em><em><span class="c011">
</span></em><em><span class="c011">     ];</span></em><em><span class="c011">
</span></em><em><span class="c011">     </span></em><em><span class="c011">fhir:Observation</span></em><em><span class="c011">.</span></em><em><span class="c011">component</span></em><em><span class="c011">.</span></em><em><span class="c011">valueQuantity</span></em><em><span class="c011"> [</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011">fhir:Quantity</span></em><em><span class="c011">.</span></em><em><span class="c011">value</span></em><em><span class="c011"> [ </span></em><em><span class="c011">fhir:value</span></em><em><span class="c011"> </span></em><em><span class="c011"><em><span class="c011">"60"</span></em></span></em><em><span class="c011">^^</span></em><em><span class="c011">xsd:decimal</span></em><em><span class="c011"> ];</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011">fhir:Quantity</span></em><em><span class="c011">.</span></em><em><span class="c011">unit</span></em><em><span class="c011"> [ </span></em><em><span class="c011">fhir:value</span></em><em><span class="c011"> </span></em><em><span class="c011"><em><span class="c011">"mmHg"</span></em></span></em><em><span class="c011"> ];</span></em><em><span class="c011">
</span></em><em><span class="c011">     ]</span></em><em><span class="c011">
</span></em><em><span class="c011">  ] .</span></em></td></tr>
</table></div></div><p>This example is long, but it is taken directly from a use case.
In fact, its length encourages us to do a bit of factoring.
While we want to keep constraints on the codes for systolic and diastolic, we can create a separate 
<code>&lt;</code><code>valueObs</code><code>&gt;</code> shape to capture the quantity measurement.</p><div class="example"><div class="theorem"><span class="c013">Example 159</span>  <em>Factored FHIR blood pressure</em><table class="lstframe c014"><tr><td class="lstlisting"><em><span class="c011"><span class="c006">PREFIX</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">fhir:</span></span></em><em><span class="c011"> &lt;</span></em><em><span class="c011"><span class="c006">http:</span></span></em><em><span class="c011">//</span></em><em><span class="c011"><span class="c006">hl7</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">org</span></span></em><em><span class="c011">/</span></em><em><span class="c011"><span class="c006">fhir</span></span></em><em><span class="c011">/&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">PREFIX</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">loinc:</span></span></em><em><span class="c011"> &lt;</span></em><em><span class="c011"><span class="c006">http:</span></span></em><em><span class="c011">//</span></em><em><span class="c011"><span class="c006">loinc</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">org</span></span></em><em><span class="c011">/</span></em><em><span class="c011"><span class="c006">owl</span></span></em><em><span class="c011">#&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">PREFIX</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">owl:</span></span></em><em><span class="c011"> &lt;</span></em><em><span class="c011"><span class="c006">http:</span></span></em><em><span class="c011">//</span></em><em><span class="c011"><span class="c006">www</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">w3</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">org</span></span></em><em><span class="c011">/2002/07/</span></em><em><span class="c011"><span class="c006">owl</span></span></em><em><span class="c011">#&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">PREFIX</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">rdfs:</span></span></em><em><span class="c011"> &lt;</span></em><em><span class="c011"><span class="c006">http:</span></span></em><em><span class="c011">//</span></em><em><span class="c011"><span class="c006">www</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">w3</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">org</span></span></em><em><span class="c011">/2000/01/</span></em><em><span class="c011"><span class="c006">rdf</span></span></em><em><span class="c011">-</span></em><em><span class="c011"><span class="c006">schema</span></span></em><em><span class="c011">#&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">PREFIX</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">sct:</span></span></em><em><span class="c011"> &lt;</span></em><em><span class="c011"><span class="c006">http:</span></span></em><em><span class="c011">//</span></em><em><span class="c011"><span class="c006">snomed</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">info</span></span></em><em><span class="c011">/</span></em><em><span class="c011"><span class="c006">id</span></span></em><em><span class="c011">/&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">PREFIX</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">xsd:</span></span></em><em><span class="c011"> &lt;</span></em><em><span class="c011"><span class="c006">http:</span></span></em><em><span class="c011">//</span></em><em><span class="c011"><span class="c006">www</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">w3</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">org</span></span></em><em><span class="c011">/2001/</span></em><em><span class="c011"><span class="c006">XMLSchema</span></span></em><em><span class="c011">#&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011"><span class="c006">BASE</span></span></em><em><span class="c011">   &lt;</span></em><em><span class="c011"><span class="c006">http:</span></span></em><em><span class="c011">//</span></em><em><span class="c011"><span class="c006">hl7</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">org</span></span></em><em><span class="c011">/</span></em><em><span class="c011"><span class="c006">fhir</span></span></em><em><span class="c011">/</span></em><em><span class="c011"><span class="c006">shape</span></span></em><em><span class="c011">/&gt;</span></em><em><span class="c011">
</span></em><em><span class="c011">
</span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">blood</span></span></em><em><span class="c011">-</span></em><em><span class="c011"><span class="c006">pressure</span></span></em><em><span class="c011">&gt; {</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">a</span></span></em><em><span class="c011"> [</span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">];</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">component</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">valueObs</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">     </span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">component</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">code</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011"><span class="c006">fhir:CodeableConcept</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">coding</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">         </span></em><em><span class="c011"><span class="c006">a</span></span></em><em><span class="c011"> [</span></em><em><span class="c011"><span class="c006">loinc:8480</span></span></em><em><span class="c011">-6] ; # </span></em><em><span class="c011"><span class="c006">systolic</span></span></em><em><span class="c011">
</span></em><em><span class="c011">       }</span></em><em><span class="c011">
</span></em><em><span class="c011">     }</span></em><em><span class="c011">
</span></em><em><span class="c011">  } ;</span></em><em><span class="c011">
</span></em><em><span class="c011">  </span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">component</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">@</span></span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">valueObs</span></span></em><em><span class="c011">&gt; </span></em><em><span class="c011"><span class="c006">AND</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">     </span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">component</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">code</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">       </span></em><em><span class="c011"><span class="c006">fhir:CodeableConcept</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">coding</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">         </span></em><em><span class="c011"><span class="c006">a</span></span></em><em><span class="c011"> [</span></em><em><span class="c011"><span class="c006">loinc:8462</span></span></em><em><span class="c011">-4] ; # </span></em><em><span class="c011"><span class="c006">diastolic</span></span></em><em><span class="c011">
</span></em><em><span class="c011">       }</span></em><em><span class="c011">
</span></em><em><span class="c011">     }</span></em><em><span class="c011">
</span></em><em><span class="c011">  }</span></em><em><span class="c011">
</span></em><em><span class="c011">}</span></em><em><span class="c011">
</span></em><em><span class="c011">
</span></em><em><span class="c011">&lt;</span></em><em><span class="c011"><span class="c006">valueObs</span></span></em><em><span class="c011">&gt; {</span></em><em><span class="c011">
</span></em><em><span class="c011">   </span></em><em><span class="c011"><span class="c006">fhir:Observation</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">component</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">valueQuantity</span></span></em><em><span class="c011"> {</span></em><em><span class="c011">
</span></em><em><span class="c011">     </span></em><em><span class="c011"><span class="c006">fhir:Quantity</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">value</span></span></em><em><span class="c011"> { </span></em><em><span class="c011"><span class="c006">fhir:value</span></span></em><em><span class="c011"> </span></em><em><span class="c011"><span class="c006">xsd:decimal</span></span></em><em><span class="c011"> };</span></em><em><span class="c011">
</span></em><em><span class="c011">     </span></em><em><span class="c011"><span class="c006">fhir:Quantity</span></span></em><em><span class="c011">.</span></em><em><span class="c011"><span class="c006">unit</span></span></em><em><span class="c011"> { </span></em><em><span class="c011"><span class="c006">fhir:value</span></span></em><em><span class="c011"> [</span></em><em><span class="c011"><span class="c006"><em><span class="c011">"mmHg"</span></em></span></span></em><em><span class="c011">] };</span></em><em><span class="c011">
</span></em><em><span class="c011">   }</span></em><em><span class="c011">
</span></em><em><span class="c011">}</span></em></td></tr>
</table></div></div><p>This schema has two repeated properties: 
<code>fhir:Observation</code><code>.</code><code>component</code> with different constraints (one for systolic and the other for diastolic). It takes advantage of ShEx’s intuitive <em>additive semantics</em> where requirements for repeated properties 
are simply expressed as additional triple patterns (see section <a href="bookHtml011.html#ch040.RepeatedPropertiesSection">4.6.7</a>).</p>
<h2 class="section" id="sec183">6.3  Springer Nature SciGraph</h2>
<p> 
<a id="ch070SciGraph"></a>
<a id="ch6.sec3"></a></p><p>Springer Nature SciGraph<sup><a id="text49" href="#note49">8</a></sup> is a new Linked Open Data platform aggregating data sources from Springer Nature and key partners from the scholarly domain. 
The platform currently collates information from across the research landscape, 
such as funders, research projects, conferences, affiliations, and publications (books and journals). 
This high-quality data from trusted and reliable sources provides a rich semantic description of how information is related, 
as well as enabling innovative visualizations of the scholarly domain.</p><p>Data quality is a key component in SciGraph. 
In earlier work, SPIN was used in various validation scenarios. 
However, SPIN was hard to maintain and to read by non-experts and SHACL was chosen instead. 
SHACL is now used to validate data before the data enters the main triplestore. 
SHACL is also used to specify which classes and properties can be published from the triplestore.</p><p>All of the SHACL shapes used in building public datasets of Springer Nature SciGraph are published in a Github 
repository.<sup><a id="text50" href="#note50">9</a></sup> 
There are shapes that define the RDF structure of all SciGraph entity types such as articles, grants, and journals. </p><p>The following snippet of the 
<code>Article</code> shape says that all SHACL instances of 
<code>sg:Article</code> must have 
exactly one 
<code>sg:scigraphId</code> that is a string, 
at most one value for 
<code>sg:doi</code>, 
a string following a specific pattern and at most one value for 
<code>sg:role</code> that can be one of:<em>author</em>, <em>editor</em> or <em>principal investigator</em>.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:Article</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:targetClass</span><span class="c011"> </span><span class="c011">sg:Article</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">rdfs:label</span><span class="c011"> </span><span class="c011"><span class="c011">"RDF shape for the sg:Article model"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><em><span class="c011"># Identity</span></em></span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sg:scigraphId</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:datatype</span><span class="c011"> </span><span class="c011">xsd:string</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:minCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">  ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sg:doi</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:datatype</span><span class="c011"> </span><span class="c011">xsd:string</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:pattern</span><span class="c011"> </span><span class="c011"><span class="c011">"^10\\.\\d{4,5}\\/\\S+$"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">  ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><em><span class="c011"># ...</span></em></span><span class="c011">
</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sg:role</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:in</span><span class="c011"> ( </span><span class="c011"><span class="c011">"author"</span></span><span class="c011"> </span><span class="c011"><span class="c011">"editor"</span></span><span class="c011"> </span><span class="c011"><span class="c011">"principal investigator"</span></span><span class="c011"> ) ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">  ] ;</span></td></tr>
</table>
<h2 class="section" id="sec184">6.4  DBpedia Validation Use Cases</h2>
<p> 
<a id="ch070DBpedia"></a>
<a id="ch6.sec4"></a></p><p>DBpedia<sup><a id="text51" href="#note51">10</a></sup> 
([<a href="bookHtml019.html#dbpedia-swj">60</a>]) is a crowdsourced community effort to extract structured information from Wikipedia and make this information available on the Web.
DBpedia data is available as RDF dumps, through a linked data interface and a SPARQL endpoint.
The current DBpedia release (version 2016-04<sup><a id="text52" href="#note52">11</a></sup>) provides circa 9.5 billion RDF triples.</p><p>Validating such large amounts of RDF data is a challenging task, and various methods have been applied.
At the time of writing, the core validation of DBpedia is performed with neither ShEx nor SHACL.
However, it is worth mentioning some approaches that work on large and noisy datasets.</p>
<h3 class="subsection" id="sec185">6.4.1  Ontology-based Validation</h3>
<p>
<a id="ch6.sec4.1"></a></p><p>One of the core sources of validation for DBpedia is the DBpedia ontology.
The DBpedia ontology is crowdsourced and maintained by the community on the 
<a href="http://mappings.dbpedia.org"><span class="c010">http://mappings.dbpedia.org</span></a> wiki.
At the time of writing, the ontology consists of circa 750 classes, organized in a hierarchy, and 2,600 properties.
The community can define class disjoint statements and for properties, axioms such as domain, range, literal datatypes, and functional properties.
The DBpedia ontology both drives the correct extraction of RDF triples from Wikipedia pages and is used in post-processing steps to remove data violations.</p><p>The DBpedia extraction framework has many extractors that parse different parts of a Wikipedia page and generate RDF triples.
The Mapping-based extractor is a special extractor that focuses on high-quality extraction from Wikipedia infoboxes.
To achieve this it uses the DBpedia ontology and the community-maintained infobox-to-ontology mappings.
Each infobox mapping maps a Wikipedia infobox template to a DBpedia class and each infobox template parameter to a property mapping (see [<a href="bookHtml019.html#dbpedia-swj">60, sec. 2.4</a>]) .
At extraction time, each property mapping is associated with a different parser, according to the 
<code>rdfs:range</code> of the DBpedia property of each property mapping.
For example, if the range of a property is defined as an 
<code>xsd:date</code> (e.g. 
<code>dbo:birthDate</code>), property mappings with this property generate a value only if the value can be parsed as a date.</p><p>As a post-processing step, the RDFS and OWL axioms defined in the DBpedia ontology are used to further clean up the extracted data. 
A common approach is to run RDFUnit on the data and get back detailed violation reports. 
These reports are used to identify common sources of error that can be planned for fixing.
Another approach is a set of scripts that parse facts and, depending on the conformance of a fact to a set of axioms (e.g., 

<code>rdfs:domain</code>, 
<code>rdfs:range</code>, 
<code>owl:disjointWith</code>, etc) 
dispatches the facts to different dataset buckets before publishing.</p>
<h3 class="subsection" id="sec186">6.4.2  RDF Mappings Validation</h3>
<p>
<a id="ch6.sec4.2"></a></p><p>A very common way to generate RDF data is through a mapping document.
In a general case, a mapping document contains rules that can be used to transform input data to RDF.
The mapping rules can be encoded in a script (e.g., using XSLT), in code, or formulated in mapping languages such as R2RML [<a href="bookHtml019.html#R2RML">28</a>] and RML [<a href="bookHtml019.html#RML">30</a>].</p><p>A single error in the mapping document can, in many cases, be propagated to many errors on the generated instance data, 
and the number of errors is usually proportional to the input size.
Consider for example a mapping document that generates person data and represents the age of a person with the property 

<code>foaf:age</code> and the value as 
<code>xsd:double</code> instead of 
<code>xsd:integer</code>.
Every person instance in the generated RDF will have a violation for the datatype of 
<code>foaf:age</code>.
Fixing such errors in the mapping document is an easy task, but 
once the data is generated the task becomes harder, especially on big datasets.</p><p>Dimou et al. [<a href="bookHtml019.html#iswc15_rml_rdfunit">31</a>] propose a workflow for including quality assessment of the mappings in the general dataset quality assessment workflow.
The authors use the dataset schema information (i.e., ontologies) to identify schema errors of the dataset directly from an RML mapping document.
The results illustrate that violations such as domain and range, mistyped datatypes, class and property disjointness, and the like can be identified directly from the mapping document.
Evaluation of this work indicates that fixing errors directly in the mapping document is more efficient. 
For example, in the case of DBpedia, an automatic quality assessment of the mappings took less than a minute while the complete dataset validation took more than 16 hours.</p><p>However, the mapping quality assessment of the mappings cannot identify all possible schema errors in the target dataset.
Some constraints, such as cardinality, can only be identified on the target dataset.</p><p><a id="hevea_default797"></a> <a id="hevea_default798"></a> 
Even though this approach currently works with OWL and RDFS, it would be an easy exercise to extend it to SHACL or ShEx.
Given a set of mappings and a set of Shapes, one could identify incompatibilities directly from the mapping document.</p>
<h3 class="subsection" id="sec187">6.4.3  Validating Link Contributions with SHACL</h3>
<p>
<a id="ch6.sec4.3"></a></p><p><a id="hevea_default799"></a> <a id="hevea_default800"></a> 
DBpedia promotes Github for accepting link contributions from the DBpedia 
community<sup><a id="text53" href="#note53">12</a></sup> 
and, recently, there has been an effort to automate the link verification process 
(see [<a href="bookHtml019.html#DojchinovskiDBpediaLinks">32, Section 3.3</a>]).
<a id="hevea_default801"></a> <a id="hevea_default802"></a> <a id="hevea_default803"></a>
This has put into place a set of quality checks that validate various aspects of the link submission and is integrated with common continuous integration services, such as Travis CI.</p><p>This approach enables instant checks on pull requests and reports problems to the submitter.
In addition to scripts that check for instance valid RDF files, 
there is a script that checks if the link manifest file conforms to the following SHACL schema.<sup><a id="text54" href="#note54">13</a></sup></p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">dbp:LinkManifest</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:targetClass</span><span class="c011"> </span><span class="c011">void:Linkset</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dc:author</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:minCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dct:description</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:minCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:Literal</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:datatype</span><span class="c011"> </span><span class="c011">xsd:string</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dct:license</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:minCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dbp:script</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:maxCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dbp:linkConf</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:maxCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dbp:ntriplefilelocation</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:maxCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dbp:endpoint</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:maxCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dbp:constructQuery</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:maxCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:Literal</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:datatype</span><span class="c011"> </span><span class="c011">xsd:string</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dbp:approvedPatch</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dbp:optionalPatch</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">dbp:updateFrequencyInDays</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:maxCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:Literal</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:datatype</span><span class="c011"> </span><span class="c011">xsd:integer</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span></td></tr>
</table><p>The defined quality checks cannot capture all possible errors in a link submission process.
However, they can 
(a) provide a very useful feedback to the link submitter, and 
(b) enable DBpedia to automatically pre-process some steps in the link generation pipeline.</p>
<h3 class="subsection" id="sec188">6.4.4  Ontology Validation with SHACL</h3>
<p>
<a id="ch6.sec4.4"></a></p><p>The DBpedia ontology has been maintained by the DBpedia community in a crowdsourced manner at the <a href="http://mappings.dbpedia.org"><span class="c010">http://mappings.dbpedia.org</span></a> wiki.
There is an ongoing effort to move ontology development onto Github for easier collaboration and for the sake of more control over the ontology structure.
<sup><a id="text55" href="#note55">14</a></sup>
At the time of writing, the following constraints are defined to ensure that each DBpedia class and each DBpedia property conform to DBpedia community requirements:</p><ul class="itemize"><li class="li-itemize">
Each DBpedia class and property must have at least one 
<code>rdfs:label</code> and at least one 
<code>rdfs:comment</code> that are of 
<code>rdf:langString</code> datatype with unique language.
</li><li class="li-itemize">Each DBpedia class can have at most one direct super class.
</li><li class="li-itemize">Each DBpedia property can have at most one direct super property.
</li><li class="li-itemize">Each DBpedia property can have at most one 
<code>rdfs:domain</code>.
</li><li class="li-itemize">Each DBpedia property can have at most one 
<code>rdfs:range</code>.
</li><li class="li-itemize">The domain and range of each property must be defined as an 
<code>owl:Class</code>.
</li><li class="li-itemize">Top-level DBpedia classes must be discussed before defined.
</li></ul><p>These constraints are implemented with the following SHACL definitions.
RDFUnit is used to perform the validation as well as integrate with Travis CI and automate the checks on each commit and pull request.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">dbo</span><span class="c011">-</span><span class="c011">shape:ClassShape</span><span class="c011">
</span><span class="c011">  </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:Shape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:targetClass</span><span class="c011"> </span><span class="c011">owl:Class</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:targetSubjectsOf</span><span class="c011"> </span><span class="c011">rdfs:subClassOf</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:severity</span><span class="c011"> </span><span class="c011">sh:Error</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:message</span><span class="c011"> </span><span class="c011"><span class="c011">"Each owl:Class should have at least one rdfs:label"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdfs:label</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:minCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:dataType</span><span class="c011"> </span><span class="c011">rdf:langString</span><span class="c011">;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:uniqueLang</span><span class="c011"> </span><span class="c011">true</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:message</span><span class="c011"> </span><span class="c011"><span class="c011">"Each owl:Class should have at least one rdfs:comment"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdfs:comment</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:minCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:dataType</span><span class="c011"> </span><span class="c011">rdf:langString</span><span class="c011">;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:uniqueLang</span><span class="c011"> </span><span class="c011">true</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:message</span><span class="c011"> </span><span class="c011"><span class="c011">"Each owl:Class should have at most one superclass"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdfs:subClassOf</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:maxCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:sparql</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:message</span><span class="c011"> </span><span class="c011"><span class="c011">"DBpedia Ontology only allows 9 top level classes, any new top level classes need to be discussed"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:severity</span><span class="c011"> </span><span class="c011">sh:Warning</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:select</span><span class="c011"> </span><span class="c011"><span class="c011">""</span></span><span class="c011"><span class="c011">"</span><span class="c011">
</span><span class="c011">      PREFIX owl: &lt;http://www.w3.org/2002/07/owl#&gt;</span><span class="c011">
</span><span class="c011">      PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;</span><span class="c011">
</span><span class="c011">      SELECT DISTINCT $this ?otherClass</span><span class="c011">
</span><span class="c011">      WHERE {</span><span class="c011">
</span><span class="c011">        $this rdfs:subClassOf owl:Thing  .</span><span class="c011">
</span><span class="c011">        FILTER($this NOT IN (</span><span class="c011">
</span><span class="c011">          &lt;http://dbpedia.org/ontology/Activity&gt;,</span><span class="c011">
</span><span class="c011">          &lt;http://dbpedia.org/ontology/Agent&gt;,</span><span class="c011">
</span><span class="c011">          &lt;http://dbpedia.org/ontology/Concept&gt;,</span><span class="c011">
</span><span class="c011">          &lt;http://dbpedia.org/ontology/CommunicationSystem&gt;,</span><span class="c011">
</span><span class="c011">          &lt;http://dbpedia.org/ontology/Condition&gt;,</span><span class="c011">
</span><span class="c011">          &lt;http://dbpedia.org/ontology/Event&gt;,</span><span class="c011">
</span><span class="c011">          &lt;http://dbpedia.org/ontology/PhysicalThing&gt;,</span><span class="c011">
</span><span class="c011">          &lt;http://dbpedia.org/ontology/Place&gt;,</span><span class="c011">
</span><span class="c011">          &lt;http://dbpedia.org/ontology/TimePeriod&gt;)</span><span class="c011">
</span><span class="c011">        ).</span><span class="c011">
</span><span class="c011">      } "</span></span><span class="c011"><span class="c011">""</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  ] .</span><span class="c011">
</span><span class="c011">
</span><span class="c011">dbo</span><span class="c011">-</span><span class="c011">shape:PropertyShape</span><span class="c011">
</span><span class="c011">  </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:Shape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:targetClass</span><span class="c011"> </span><span class="c011">rdf:Property</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:targetClass</span><span class="c011"> </span><span class="c011">owl:DatatypeProperty</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:targetClass</span><span class="c011"> </span><span class="c011">owl:ObjectProperty</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:targetSubjectsOf</span><span class="c011"> </span><span class="c011">rdfs:subPropertyOf</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:message</span><span class="c011"> </span><span class="c011"><span class="c011">"Each property should have at least one rdfs:label"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdfs:label</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:minCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:dataType</span><span class="c011"> </span><span class="c011">rdf:langString</span><span class="c011">;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:uniqueLang</span><span class="c011"> </span><span class="c011">true</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:message</span><span class="c011"> </span><span class="c011"><span class="c011">"Each property should have at least one rdfs:comment"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdfs:comment</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:minCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:dataType</span><span class="c011"> </span><span class="c011">rdf:langString</span><span class="c011">;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:uniqueLang</span><span class="c011"> </span><span class="c011">true</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:message</span><span class="c011"> </span><span class="c011"><span class="c011">"Each property should have at most one rdfs:domain"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdfs:domain</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:maxCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:message</span><span class="c011"> </span><span class="c011"><span class="c011">"Each property should have an rdfs:domain that is defined as an owl:Class"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdfs:domain</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:class</span><span class="c011"> </span><span class="c011">owl:Class</span><span class="c011">;</span><span class="c011">
</span><span class="c011">  ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:message</span><span class="c011"> </span><span class="c011"><span class="c011">"Each property should have at most one rdfs:range"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdfs:range</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:maxCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:message</span><span class="c011"> </span><span class="c011"><span class="c011">"Each property should have an rdfs:range that is defined as an owl:Class"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdfs:range</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:class</span><span class="c011"> </span><span class="c011">owl:Class</span><span class="c011">;</span><span class="c011">
</span><span class="c011">  ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:message</span><span class="c011"> </span><span class="c011"><span class="c011">"Each property should have at most one super property"</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdfs:subPropertyOf</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:maxCount</span><span class="c011"> 1;</span><span class="c011">
</span><span class="c011">  ] .</span></td></tr>
</table><p>An interesting part of this use case is the use of SHACL-SPARQL to define the complex constraint <em>Top-level DBpedia classes must be discussed before defined</em>.
Here, only nine specific classes are allowed as top-level classes (i.e. classes with no superclass except 
<code>owl:Thing</code>) and are hard-coded in the SPARQL query.
Even though this creates a tight coupling of the shape to the data, top-level DBpedia classes are not changing frequently and adjusting the constraint can indeed stimulate discussion.</p>
<h2 class="section" id="sec189">6.5  ShEx for ShEx</h2>
<p> 
<a id="ch070ShExForShEx"></a>
<a id="ch6.sec5"></a></p><p><a id="hevea_default804"></a>
Given that one serialization format for ShEx is RDF, it is possible to use ShEx to validate itself, i.e., 
to validate RDF graphs representing ShEx schemas. 
The RDF serialization representation of ShEx is called ShExR.</p><p>The following example contains a simple ShEx schema using ShExR in Turtle:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;&gt; </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sx:Schema</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sx:shapes</span><span class="c011"> </span><span class="c011">:User</span><span class="c011"> .</span><span class="c011">
</span><span class="c011">
</span><span class="c011">:User</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sx:Shape</span><span class="c011">;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sx:expression</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sx:EachOf</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sx:expressions</span><span class="c011"> (</span><span class="c011">
</span><span class="c011">   [ </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sx:TripleConstraint</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">     </span><span class="c011">sx:predicate</span><span class="c011"> </span><span class="c011">schema:name</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">     </span><span class="c011">sx:valueExpr</span><span class="c011"> [ </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sx:NodeConstraint</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">       </span><span class="c011">sx:datatype</span><span class="c011"> </span><span class="c011">xsd:string</span><span class="c011"> ]</span><span class="c011">
</span><span class="c011">   ]</span><span class="c011">
</span><span class="c011">   [ </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sx:TripleConstraint</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">     </span><span class="c011">sx:predicate</span><span class="c011"> </span><span class="c011">schema:gender</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">     </span><span class="c011">sx:valueExpr</span><span class="c011"> [ </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sx:NodeConstraint</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">       </span><span class="c011">sx:values</span><span class="c011"> ( </span><span class="c011">schema:Male</span><span class="c011"> </span><span class="c011">schema:Female</span><span class="c011"> )</span><span class="c011">
</span><span class="c011">     ]</span><span class="c011">
</span><span class="c011">   ]</span><span class="c011">
</span><span class="c011">  )</span><span class="c011">
</span><span class="c011"> ] .</span></td></tr>
</table><p>In the following, we will describe the ShEx schemas that can validate RDF files in ShExR (as above). 
The full code is included in the annex <a href="bookHtml017.html#AnnexShExInShEx">C</a> and has been adapted from Appendix C (ShEx shape) 
of the ShEx specification.<sup><a id="text56" href="#note56">15</a></sup> </p><p><a id="hevea_default805"></a> <a id="hevea_default806"></a> 
ShExR graphs contain an RDF node with 
<code>rdf:type</code><code> </code><code>sx:Schema</code>, 
an optional list of starting semantic actions, 
a start declaration and zero or more 
<code>sx:shapes</code> declarations whose values
must be shape expressions 
<code>&lt;</code><code>ShapeExpr</code><code>&gt;</code>.</p><p>Most of the shapes in this schema are defined as 
<code>CLOSED</code> to limit the appearance of unexpected triples.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">Schema</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">            [</span><span class="c011"><span class="c006">sx:Schema</span></span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:startActs</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">SemActList1Plus</span></span><span class="c011">&gt;? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:start</span></span><span class="c011">     </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">ShapeExpr</span></span><span class="c011">&gt;?;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:shapes</span></span><span class="c011">    </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">ShapeExpr</span></span><span class="c011">&gt;*</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>As discussed in Section <a href="bookHtml011.html#ch040StructureofaShapeExpression">4.4.3</a>, there are six possibilities for defining shape expressions.
Which can be enumerated as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">ShapeExpr</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">ShapeOr</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011">
</span><span class="c011">            </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">ShapeAnd</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011">
</span><span class="c011">            </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">ShapeNot</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011">
</span><span class="c011">            </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">NodeConstraint</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011">
</span><span class="c011">            </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">Shape</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011">
</span><span class="c011">            </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">ShapeExternal</span></span><span class="c011">&gt;</span></td></tr>
</table><p>
<code>&lt;</code><code>ShapeOr</code><code>&gt;</code> and 
<code>&lt;</code><code>ShapeAnd</code><code>&gt;</code> have a similar representation which contains a list of at least two shape expressions 
represented by the 
<code>&lt;</code><code>shapeExprList2Plus</code><code>&gt;</code> shape, which will be described later.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">ShapeOr</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">             [</span><span class="c011"><span class="c006">sx:ShapeOr</span></span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:shapeExprs</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">shapeExprList2Plus</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">}</span><span class="c011">
</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">ShapeAnd</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">             [</span><span class="c011"><span class="c006">sx:ShapeAnd</span></span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:shapeExprs</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">shapeExprList2Plus</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>
<code>&lt;</code><code>ShapeNot</code><code>&gt;</code> contains a shape expression:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">ShapeNot</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">            [</span><span class="c011"><span class="c006">sx:ShapeNot</span></span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:shapeExpr</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">shapeExpr</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>The following code represents lists of shape expressions. 
<code>&lt;</code><code>shapeExprList2Plus</code> is a list of at least two shape expressions, and 
<code>&lt;</code><code>shapeExprList1Plus</code><code>&gt;</code> is a list of at least one.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">shapeExprList2Plus</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">rdf:first</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">shapeExpr</span></span><span class="c011">&gt; ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">rdf:rest</span></span><span class="c011">  </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">shapeExprList1Plus</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">}</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">shapeExprList1Plus</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">rdf:first</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">shapeExpr</span></span><span class="c011">&gt; ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">rdf:rest</span></span><span class="c011">  [</span><span class="c011"><span class="c006">rdf:nil</span></span><span class="c011">] </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">shapeExprList1Plus</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>Node constraints are formed by one or more declarations of node kind, 
datatype, 
string facet, 
numeric facet, or 
a list of possible values.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">NodeConstraint</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">             [</span><span class="c011"><span class="c006">sx:NodeConstraint</span></span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">  ( </span><span class="c011"><span class="c006">sx:nodeKind</span></span><span class="c011"> [</span><span class="c011"><span class="c006">sx:iri</span></span><span class="c011"> </span><span class="c011"><span class="c006">sx:bnode</span></span><span class="c011"> </span><span class="c011"><span class="c006">sx:literal</span></span><span class="c011"> </span><span class="c011"><span class="c006">sx:nonliteral</span></span><span class="c011">]</span><span class="c011">
</span><span class="c011">  | </span><span class="c011"><span class="c006">sx:datatype</span></span><span class="c011"> </span><span class="c011"><span class="c006">IRI</span></span><span class="c011">
</span><span class="c011">  | &amp;&lt;</span><span class="c011"><span class="c006">stringFacet</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">  | &amp;&lt;</span><span class="c011"><span class="c006">numericFacet</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">  | </span><span class="c011"><span class="c006">sx:values</span></span><span class="c011">   </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">valueSetValueList1Plus</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">  )+</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>A shape can contain the Boolean directives 
<code>sx:closed</code> and 
<code>sx:extra</code> as well as a 
<code>sx:tripleExpression</code> and an optional list of semantic actions.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">Shape</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">             [</span><span class="c011"><span class="c006">sx:Shape</span></span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:closed</span></span><span class="c011">     [</span><span class="c011"><span class="c006">true</span></span><span class="c011"> </span><span class="c011"><span class="c006">false</span></span><span class="c011">]? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:extra</span></span><span class="c011">      </span><span class="c011"><span class="c006">IRI</span></span><span class="c011">* ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:expression</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">tripleExpression</span></span><span class="c011">&gt;? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:semActs</span></span><span class="c011">    </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">SemActList1Plus</span></span><span class="c011">&gt;? ;</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>External shapes only contain a type declaration.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">ShapeExternal</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">            [</span><span class="c011"><span class="c006">sx:ShapeExternal</span></span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>Semantic actions contain a 
<code>sx:name</code> that points to an IRI describing the processor and a 
<code>sx:code</code> value with the string code that will be passed to that processor.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">SemAct</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">            [</span><span class="c011"><span class="c006">sx:SemAct</span></span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:name</span></span><span class="c011">      </span><span class="c011"><span class="c006">IRI</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:code</span></span><span class="c011">      </span><span class="c011"><span class="c006">xsd:string</span></span><span class="c011">?</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>Annotations contain a predicate (which must be an IRI) and an object. </p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">Annotation</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">            [</span><span class="c011"><span class="c006">sx:Annotation</span></span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:predicate</span></span><span class="c011"> </span><span class="c011"><span class="c006">IRI</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:object</span></span><span class="c011">    </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">objectValue</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>String and numeric facets just enumerate the different possibilities:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">stringFacet</span></span><span class="c011">&gt; {</span><span class="c011">
</span><span class="c011">    </span><span class="c011"><span class="c006">sx:length</span></span><span class="c011">         </span><span class="c011"><span class="c006">xsd:integer</span></span><span class="c011">
</span><span class="c011">  | </span><span class="c011"><span class="c006">sx:minlength</span></span><span class="c011">      </span><span class="c011"><span class="c006">xsd:integer</span></span><span class="c011">
</span><span class="c011">  | </span><span class="c011"><span class="c006">sx:maxlength</span></span><span class="c011">      </span><span class="c011"><span class="c006">xsd:integer</span></span><span class="c011">
</span><span class="c011">  | </span><span class="c011"><span class="c006">sx:pattern</span></span><span class="c011">        </span><span class="c011"><span class="c006">xsd:string</span></span><span class="c011">
</span><span class="c011">}</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">numericFacet</span></span><span class="c011">&gt; {</span><span class="c011">
</span><span class="c011">    </span><span class="c011"><span class="c006">sx:mininclusive</span></span><span class="c011">   </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">numericLiteral</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">  | </span><span class="c011"><span class="c006">sx:minexclusive</span></span><span class="c011">   </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">numericLiteral</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">  | </span><span class="c011"><span class="c006">sx:maxinclusive</span></span><span class="c011">   </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">numericLiteral</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">  | </span><span class="c011"><span class="c006">sx:maxexclusive</span></span><span class="c011">   </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">numericLiteral</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">  | </span><span class="c011"><span class="c006">sx:totaldigits</span></span><span class="c011">    </span><span class="c011"><span class="c006">xsd:integer</span></span><span class="c011">
</span><span class="c011">  | </span><span class="c011"><span class="c006">sx:fractiondigits</span></span><span class="c011"> </span><span class="c011"><span class="c006">xsd:integer</span></span><span class="c011">
</span><span class="c011">}</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">numericLiteral</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">xsd:integer</span></span><span class="c011"> </span><span class="c011"><span class="c006">OR</span></span><span class="c011">
</span><span class="c011">                 </span><span class="c011"><span class="c006">xsd:decimal</span></span><span class="c011"> </span><span class="c011"><span class="c006">OR</span></span><span class="c011">
</span><span class="c011">                 </span><span class="c011"><span class="c006">xsd:double</span></span></td></tr>
</table><p>The values that can appear in a value set are object values, stems, or ranges:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">valueSetValue</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">objectValue</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">IriStem</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">IriStemRange</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">LiteralStem</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">LiteralStemRange</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">LanguageStem</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">LanguageStemRange</span></span><span class="c011">&gt;</span></td></tr>
</table><p>Object values can be IRIs or literals:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">objectValue</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">IRI</span></span><span class="c011"> </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">LITERAL</span></span></td></tr>
</table><p>Stems and ranges are defined for the different possibilities: IRIs, literals, or language-tagged literals.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">IriStem</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> { </span><span class="c011"><span class="c006">a</span></span><span class="c011"> [</span><span class="c011"><span class="c006">sx:IriStem</span></span><span class="c011">]; </span><span class="c011"><span class="c006">sx:stem</span></span><span class="c011"> </span><span class="c011"><span class="c006">xsd:anyUri</span></span><span class="c011"> }</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">IriStemRange</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011"> [</span><span class="c011"><span class="c006">sx:IriStemRange</span></span><span class="c011">];</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:stem</span></span><span class="c011"> </span><span class="c011"><span class="c006">xsd:anyUri</span></span><span class="c011"> </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">Wildcard</span></span><span class="c011">&gt;;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:exclusion</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">objectValue</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">IriStem</span></span><span class="c011">&gt;*</span><span class="c011">
</span><span class="c011">}</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">LiteralStem</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> { </span><span class="c011"><span class="c006">a</span></span><span class="c011"> [</span><span class="c011"><span class="c006">sx:LiteralStem</span></span><span class="c011">]; </span><span class="c011"><span class="c006">sx:stem</span></span><span class="c011"> </span><span class="c011"><span class="c006">xsd:string</span></span><span class="c011"> }</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">LiteralStemRange</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011"> [</span><span class="c011"><span class="c006">sx:LiteralStemRange</span></span><span class="c011">];</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:stem</span></span><span class="c011"> </span><span class="c011"><span class="c006">xsd:string</span></span><span class="c011"> </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">Wildcard</span></span><span class="c011">&gt;;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:exclusion</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">objectValue</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">LiteralStem</span></span><span class="c011">&gt;*</span><span class="c011">
</span><span class="c011">}</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">LanguageStem</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> { </span><span class="c011"><span class="c006">a</span></span><span class="c011"> [</span><span class="c011"><span class="c006">sx:LanguageStem</span></span><span class="c011">]; </span><span class="c011"><span class="c006">sx:stem</span></span><span class="c011"> </span><span class="c011"><span class="c006">xsd:string</span></span><span class="c011"> }</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">LanguageStemRange</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011"> [</span><span class="c011"><span class="c006">sx:LanguageStemRange</span></span><span class="c011">];</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:stem</span></span><span class="c011"> </span><span class="c011"><span class="c006">xsd:string</span></span><span class="c011"> </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">Wildcard</span></span><span class="c011">&gt;;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:exclusion</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">objectValue</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">LanguageStem</span></span><span class="c011">&gt;*</span><span class="c011">
</span><span class="c011">}</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">Wildcard</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">BNODE</span></span><span class="c011"> </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">           [</span><span class="c011"><span class="c006">sx:Wildcard</span></span><span class="c011">]</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>A triple expression is either a triple constraint, an inclusion of another shape expression of a composed triple expression made from 

<code>&lt;</code><code>OneOf</code><code>&gt;</code> or 
<code>&lt;</code><code>EachOf</code><code>&gt;</code>.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">tripleExpression</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">TripleConstraint</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011">
</span><span class="c011">                   </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">OneOf</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011">
</span><span class="c011">                   </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">EachOf</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">OR</span></span><span class="c011">
</span><span class="c011">                   </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">Inclusion</span></span><span class="c011">&gt;</span></td></tr>
</table><p>The definition of 
<code>&lt;</code><code>OneOf</code><code>&gt;</code> and 
<code>&lt;</code><code>EachOf</code><code>&gt;</code> is very similar: 
they contain 
<code>sx:min</code> and 
<code>sx:max</code> cardinalities. 
a list of at least two triple expressions, 
and optional list of semantic actions and a list of annotations.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">OneOf</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">              [</span><span class="c011"><span class="c006">sx:OneOf</span></span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:min</span></span><span class="c011">         </span><span class="c011"><span class="c006">xsd:integer</span></span><span class="c011">? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:max</span></span><span class="c011">         </span><span class="c011"><span class="c006">xsd:integer</span></span><span class="c011">?  ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:expressions</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">tripleExpressionList2Plus</span></span><span class="c011">&gt; ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:semActs</span></span><span class="c011">     </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">SemActList1Plus</span></span><span class="c011">&gt;? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:annotation</span></span><span class="c011">  </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">Annotation</span></span><span class="c011">&gt;*</span><span class="c011">
</span><span class="c011">}</span><span class="c011">
</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">EachOf</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">              [</span><span class="c011"><span class="c006">sx:EachOf</span></span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:min</span></span><span class="c011">         </span><span class="c011"><span class="c006">xsd:integer</span></span><span class="c011">? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:max</span></span><span class="c011">         </span><span class="c011"><span class="c006">xsd:integer</span></span><span class="c011">? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:expressions</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">tripleExpressionList2Plus</span></span><span class="c011">&gt; ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:semActs</span></span><span class="c011">     </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">SemActList1Plus</span></span><span class="c011">&gt;? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:annotation</span></span><span class="c011">  </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">Annotation</span></span><span class="c011">&gt;*</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>
<code>&lt;</code><code>tripleExpressionList2Plus</code><code>&gt;</code> declares a list of at least two triple expressions.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">tripleExpressionList2Plus</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">rdf:first</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">tripleExpression</span></span><span class="c011">&gt; ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">rdf:rest</span></span><span class="c011">  </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">tripleExpressionList1Plus</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">}</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">tripleExpressionList1Plus</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">rdf:first</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">tripleExpression</span></span><span class="c011">&gt; ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">rdf:rest</span></span><span class="c011">  [</span><span class="c011"><span class="c006">rdf:nil</span></span><span class="c011">] </span><span class="c011"><span class="c006">OR</span></span><span class="c011">
</span><span class="c011">            </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">tripleExpressionList1Plus</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>A 
<code>&lt;</code><code>tripleConstraint</code><code>&gt;</code> contains a mandatory 
<code>sx:predicate</code> property, an optional value expression, the cardinality declarations 
<code>sx:min</code> and 
<code>sx:max</code>, the 
<code>sx:inverse</code> and 
<code>sx:negated</code> qualifiers and the semantic actions and annotations.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">TripleConstraint</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">             [</span><span class="c011"><span class="c006">sx:TripleConstraint</span></span><span class="c011">] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:inverse</span></span><span class="c011">    [</span><span class="c011"><span class="c006">true</span></span><span class="c011"> </span><span class="c011"><span class="c006">false</span></span><span class="c011">]? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:negated</span></span><span class="c011">    [</span><span class="c011"><span class="c006">true</span></span><span class="c011"> </span><span class="c011"><span class="c006">false</span></span><span class="c011">]? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:min</span></span><span class="c011">        </span><span class="c011"><span class="c006">xsd:integer</span></span><span class="c011">? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:max</span></span><span class="c011">        </span><span class="c011"><span class="c006">xsd:integer</span></span><span class="c011">? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:predicate</span></span><span class="c011">  </span><span class="c011"><span class="c006">IRI</span></span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:valueExpr</span></span><span class="c011">  </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">shapeExpr</span></span><span class="c011">&gt;? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:semActs</span></span><span class="c011">    </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">SemActList1Plus</span></span><span class="c011">&gt;? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:annotation</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">Annotation</span></span><span class="c011">&gt;*</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>An inclusion has a predicate 
<code>sx:include</code> that points to an IRI or a blank node (non-literals).</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">Inclusion</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">a</span></span><span class="c011">          [</span><span class="c011"><span class="c006">sx:Inclusion</span></span><span class="c011">]? ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">sx:include</span></span><span class="c011"> </span><span class="c011"><span class="c006">NONLITERAL</span></span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table><p>The following definitions declare lists of at least one element: semantic actions or value set values.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">&lt;</span><span class="c011"><span class="c006">SemActList1Plus</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">rdf:first</span></span><span class="c011">  </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">SemAct</span></span><span class="c011">&gt; ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">rdf:rest</span></span><span class="c011">   [</span><span class="c011"><span class="c006">rdf:nil</span></span><span class="c011">] </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">SemActList1Plus</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">}</span><span class="c011">
</span><span class="c011">&lt;</span><span class="c011"><span class="c006">valueSetValueList1Plus</span></span><span class="c011">&gt; </span><span class="c011"><span class="c006">CLOSED</span></span><span class="c011"> {</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">rdf:first</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">valueSetValue</span></span><span class="c011">&gt; ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011"><span class="c006">rdf:rest</span></span><span class="c011">  [</span><span class="c011"><span class="c006">rdf:nil</span></span><span class="c011">] </span><span class="c011"><span class="c006">OR</span></span><span class="c011"> </span><span class="c011"><span class="c006">@</span></span><span class="c011">&lt;</span><span class="c011"><span class="c006">valueSetValueList1Plus</span></span><span class="c011">&gt;</span><span class="c011">
</span><span class="c011">}</span></td></tr>
</table>
<h2 class="section" id="sec190">6.6  SHACL in SHACL</h2>
<p> 
<a id="ch070ShaclInShacl"></a></p><p>In this section we describe how to use SHACL to validate Shapes graphs that contain SHACL code. 
This is similar to what we described in the previous section although in this case we are using SHACL to validate SHACL. 
The full code described in this section appears in 
Appendix <a href="bookHtml018.html#annexSHACLinSHACL">D</a> 
and has been adapted from Appendix C of the SHACL specification. 
We have done some modifications to the original code for readability.</p><p>The document declares the shape of shapes 
<code>:ShapeShape</code> as a 
<code>sh:NodeShape</code> that contains a long list of target declarations to define the nodes that must be validated as shapes. </p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011"> </span><span class="c011">sh:targetClass</span><span class="c011">      </span><span class="c011">sh:NodeShape,</span><span class="c011"> </span><span class="c011">sh:PropertyShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:targetSubjectsOf</span><span class="c011"> </span><span class="c011">sh:targetClass,</span><span class="c011"> </span><span class="c011">sh:targetNode,</span><span class="c011">
</span><span class="c011">                     </span><span class="c011">sh:targetObjectsOf,</span><span class="c011"> </span><span class="c011">sh:targetSubjectsOf</span><span class="c011"> </span><span class="c011">,</span><span class="c011">
</span><span class="c011">                     </span><span class="c011">sh:and,</span><span class="c011"> </span><span class="c011">sh:class,</span><span class="c011"> </span><span class="c011">sh:closed,</span><span class="c011"> </span><span class="c011">sh:datatype,</span><span class="c011">
</span><span class="c011">                     </span><span class="c011">sh:disjoint,</span><span class="c011"> </span><span class="c011">sh:equals,</span><span class="c011"> </span><span class="c011">sh:flags,</span><span class="c011"> </span><span class="c011">sh:hasValue,</span><span class="c011">
</span><span class="c011">                     ... </span><span class="c011"><em><span class="c011"># All the other constraint component parameters</span></em></span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:targetObjectsOf</span><span class="c011">  </span><span class="c011">sh:node,</span><span class="c011"> </span><span class="c011">sh:not,</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> </span><span class="c011">sh:qualifiedValueShape</span><span class="c011"> .</span></td></tr>
</table><p>It declares that every node that is an instance of 
<code>sh:NodeShape</code> or 
<code>sh:PropertyShape</code> 
must conform to 
<code>:ShapeShape</code> 
and that the subjects of properties 
<code>sh:targetClass</code>, 
<code>sh:targetNode</code>, …must also conform to 
<code>:ShapeShape</code> 
as well as the objects of 
<code>sh:node</code>, 
<code>sh:not</code>, 
<code>sh:property</code>, 
and 
<code>sh:qualifiedValueShape</code>.</p><p>The next statement declares that nodes conforming to shapes, 
must conform to one of 
<code>:NodeShapeShape</code> or 
<code>:PropertyShapeShape</code>. </p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:ShapeShape</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:xone</span><span class="c011"> ( </span><span class="c011">:NodeShapeShape</span><span class="c011"> </span><span class="c011">:PropertyShapeShape</span><span class="c011"> ) ;</span></td></tr>
</table><p>The following statements declare the types of values that can be associated with target declarations.</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:ShapeShape</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:targetNode</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRIOrLiteral</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:targetClass</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:targetSubjectsOf</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:targetObjectsOf</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> ...</span></td></tr>
</table><p>In the same way, it declares the values that can have the different constraint components. </p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:ShapeShape</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:severity</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:deactivated</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:in</span><span class="c011"> ( </span><span class="c011">true</span><span class="c011"> </span><span class="c011">false</span><span class="c011"> ) ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:and</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:ListShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:class</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> ...</span></td></tr>
</table><p>We omit the full list of declarations as all of them follow the same style. 
They declare the expected value of each predicate. For example, in the last case, 
that the predicate 
<code>sh:class</code> can have an IRI as value.</p><p>A remarkable aspect is the following declaration:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:ShapeShape</span><span class="c011"> </span><span class="c011">sh:or</span><span class="c011"> (</span><span class="c011">
</span><span class="c011">  [ </span><span class="c011">sh:not</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">     </span><span class="c011">sh:class</span><span class="c011"> </span><span class="c011">rdfs:Class</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">     </span><span class="c011">sh:or</span><span class="c011"> ( [ </span><span class="c011">sh:class</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ]</span><span class="c011">
</span><span class="c011">             [ </span><span class="c011">sh:class</span><span class="c011"> </span><span class="c011">sh:PropertyShape</span><span class="c011"> ]</span><span class="c011">
</span><span class="c011">           )</span><span class="c011">
</span><span class="c011">    ]</span><span class="c011">
</span><span class="c011">  ]</span><span class="c011">
</span><span class="c011">  [ </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ]</span><span class="c011">
</span><span class="c011"> ).</span></td></tr>
</table><p>It represents a syntax rule of implicit class targets 
(see Section <a href="bookHtml012.html#ch050implicitTargetClass">5.7.3</a>) by which a NodeShape or PropertyShape that are also instances of 
<code>rdfs:Class</code> must be IRIs. 
This is an example of an 
IF-THEN pattern (see Section <a href="bookHtml012.html#ch050IFTHENSHACL">5.11.5</a>) and could be defined in pseudo-code as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">IF</span><span class="c011"> (</span><span class="c011">sh:class</span><span class="c011"> </span><span class="c011">rdfs:Class</span><span class="c011"> </span><span class="c011">AND</span><span class="c011">
</span><span class="c011">    (</span><span class="c011">sh:class</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> </span><span class="c011">OR</span><span class="c011"> </span><span class="c011">sh:class</span><span class="c011"> </span><span class="c011">sh:PropertyShape</span><span class="c011">)</span><span class="c011">
</span><span class="c011">   ) </span><span class="c011">THEN</span><span class="c011"> </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span></td></tr>
</table><p>Another interesting declaration is:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:message</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:or</span><span class="c011"> ( [ </span><span class="c011">sh:datatype</span><span class="c011"> </span><span class="c011">xsd:string</span><span class="c011"> ]</span><span class="c011">
</span><span class="c011">          [ </span><span class="c011">sh:datatype</span><span class="c011"> </span><span class="c011">rdf:langString</span><span class="c011"> ] ) ;</span><span class="c011">
</span><span class="c011">        ] .</span></td></tr>
</table><p>which declares that messages can be any string literal or languages tagged string literal, which is a common pattern for messages 
that admit not only plain string literals but multilingual ones.</p><p>Another aspect that can be remarked is the use of 
<code>:ListShape</code> as the value of several predicates like 

<code>sh:and</code>, 
<code>sh:or</code>, 
<code>sh:in</code>, 
<code>sh:ignoredProperties</code>, and 
<code>sh:xone</code>.</p><p>The declarations are done as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:and</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:ListShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:or</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:ListShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011"><em><span class="c011"># ... similar for the other predicates </span></em></span><span class="c011">
</span><span class="c011">.</span></td></tr>
</table><p><a id="hevea_default807"></a>
The meaning is that the values of those predicates must be well-formed RDF lists 
(see Section <a href="bookHtml009.html#ch020RDFLists">2.2</a>). </p><p><a id="hevea_default808"></a>
<a id="hevea_default809"></a>
<a id="hevea_default810"></a>
An RDF list is a collection of values linked by the 
<code>rdf:rest</code> predicate whose last value is 
<code>rdf:nil</code>. 
Each node in the list must contain exactly one value of 
<code>rdf:first</code>.
The declaration of 
<code>:ListShape</code> is defined as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> [ </span><span class="c011">sh:zeroOrMorePath</span><span class="c011"> </span><span class="c011">rdf:rest</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:hasValue</span><span class="c011"> </span><span class="c011">rdf:nil</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:ListNodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] .</span></td></tr>
</table><p>which means that all the nodes are linked by the predicate 
<code>rdf:rest</code> zero or more times, and that those nodes must conform to 
<code>:ListNodeShape</code> which is defined as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">  </span><span class="c011">sh:or</span><span class="c011"> (</span><span class="c011">
</span><span class="c011">    [ </span><span class="c011">sh:hasValue</span><span class="c011"> </span><span class="c011">rdf:nil</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">      </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdf:first</span><span class="c011"> ; </span><span class="c011">sh:maxCount</span><span class="c011"> 0 ] ;</span><span class="c011">
</span><span class="c011">      </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdf:rest</span><span class="c011"> ; </span><span class="c011">sh:maxCount</span><span class="c011"> 0 ] ;</span><span class="c011">
</span><span class="c011">        ]</span><span class="c011">
</span><span class="c011">    [ </span><span class="c011">sh:not</span><span class="c011"> [ </span><span class="c011">sh:hasValue</span><span class="c011"> </span><span class="c011">rdf:nil</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011">      </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdf:first</span><span class="c011"> ; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ; </span><span class="c011">sh:minCount</span><span class="c011"> 1 ] ;</span><span class="c011">
</span><span class="c011">      </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">rdf:rest</span><span class="c011"> ; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ; </span><span class="c011">sh:minCount</span><span class="c011"> 1 ] ;</span><span class="c011">
</span><span class="c011">    ]) .</span></td></tr>
</table><p>This means that a list node is either 
<code>rdf:nil</code>, in which case it must not have any arc with predicates 
<code>rdf:first</code> or 
<code>rdf:rest</code>, or 
a node with exactly one value for those predicates.
In this case, the pattern followed is an 
<code>IF</code><code>-</code><code>THEN</code><code>-</code><code>ELSE</code> pattern.</p><p>In the case of 
<code>sh:ignoredProperties</code> and 
<code>sh:languageIn</code>, 
the list nodes must also conform to some specific shape (to be an IRI or a string). This can be expressed as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> (</span><span class="c011">sh:ignoredProperties</span><span class="c011"> [</span><span class="c011">sh:zeroOrMorePath</span><span class="c011"> </span><span class="c011">rdf:rest</span><span class="c011">] </span><span class="c011">rdf:first</span><span class="c011">);</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ];</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> (</span><span class="c011">sh:languageIn</span><span class="c011"> [</span><span class="c011">sh:zeroOrMorePath</span><span class="c011"> </span><span class="c011">rdf:rest</span><span class="c011">] </span><span class="c011">rdf:first</span><span class="c011">) ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:datatype</span><span class="c011"> </span><span class="c011">xsd:string</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] .</span></td></tr>
</table><p>Similarly, a constraint is established on the values of 
<code>sh:and</code>, 
<code>sh:or</code> and 
<code>sh:xone</code> which must be lists of nodes conforming to 
<code>:ShapeShape</code>. This is declared as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:ShapesListShape</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:path</span><span class="c011"> ( [ </span><span class="c011">sh:zeroOrMorePath</span><span class="c011"> </span><span class="c011">rdf:rest</span><span class="c011"> ] </span><span class="c011">rdf:first</span><span class="c011"> ) ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:ShapeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] .</span></td></tr>
</table><p>Some properties, like the 
<code>sh:path</code>, 
<code>sh:lessThan</code>, 
<code>sh:minCount</code>, etc. cannot be applied to node shapes. 
This constraint is declared as:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:NodeShapeShape</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:path</span><span class="c011"> ; </span><span class="c011">sh:maxCount</span><span class="c011"> 0 ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:lessThan</span><span class="c011"> ; </span><span class="c011">sh:maxCount</span><span class="c011"> 0 ] ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:maxCount</span><span class="c011">; </span><span class="c011">sh:maxCount</span><span class="c011"> 0 ];</span><span class="c011">
</span><span class="c011"> ... </span><span class="c011"><em><span class="c011"># Similar for sh:lessThanOrEquals, sh:minCount, </span></em></span><span class="c011">
</span><span class="c011">     </span><span class="c011"><em><span class="c011">#             sh:qualifiedValueShape and sh:uniqueLang</span></em></span></td></tr>
</table><p>Property shapes must have exactly one value for property 
<code>sh:path</code>. </p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:PropertyShapeShape</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:path</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ; </span><span class="c011">sh:minCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:PathShape</span><span class="c011">
</span><span class="c011"> ] .</span></td></tr>
</table><p>The value of 
<code>sh:path</code> must conform to 
<code>:PathShape</code>. 
The first version of 
<code>:PathShape</code> employed recursion with the following pattern:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:PathShape</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:xone</span><span class="c011"> (</span><span class="c011">
</span><span class="c011">   [ </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ]</span><span class="c011">
</span><span class="c011">   [ </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:BlankNode</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">     </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:PathListWithAtLeast2Members</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   ]</span><span class="c011">
</span><span class="c011">   [ </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:BlankNode</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">     </span><span class="c011">sh:closed</span><span class="c011"> </span><span class="c011">true</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">         </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:alternativePath</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">            </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:PathListWithAtLeast2Members</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">            </span><span class="c011">sh:minCount</span><span class="c011"> 1 ; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">     ]</span><span class="c011">
</span><span class="c011">   ]</span><span class="c011">
</span><span class="c011">   [ </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:BlankNode</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">     </span><span class="c011">sh:closed</span><span class="c011"> </span><span class="c011">true</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">     </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:inversePath</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">      </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:PathShape</span><span class="c011"> ;  </span><span class="c011"><em><span class="c011"># Recursive reference</span></em></span><span class="c011">
</span><span class="c011">      </span><span class="c011">sh:minCount</span><span class="c011"> 1 ; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">     ]</span><span class="c011">
</span><span class="c011">   ]</span><span class="c011">
</span><span class="c011">  ...</span><span class="c011"><em><span class="c011"># similar for sh:zeroOrMorePath, sh:oneOrMorePath </span></em></span><span class="c011">
</span><span class="c011">     </span><span class="c011"><em><span class="c011"># and sh:zeroOrOnePath</span></em></span><span class="c011">
</span><span class="c011"> );</span><span class="c011">
</span><span class="c011">.</span></td></tr>
</table><p>However, as recursion is undefined in SHACL, that definition was changed to simulate recursion using the property path 
<code>sh:zeroOrMorePath</code> with an auxiliary shape 
(see Section <a href="bookHtml012.html#ch050RecursionPropertyPaths">5.12.1</a>). 
The new definition is:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:PathShape</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> [ </span><span class="c011">sh:zeroOrMorePath</span><span class="c011"> </span><span class="c011">_:PathPath</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011">  </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:PathNodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ] .</span><span class="c011">
</span><span class="c011">
</span><span class="c011">_:PathPath</span><span class="c011"> </span><span class="c011">sh:alternativePath</span><span class="c011"> (</span><span class="c011">
</span><span class="c011"> ( [ </span><span class="c011">sh:zeroOrMorePath</span><span class="c011"> </span><span class="c011">rdf:rest</span><span class="c011"> ] </span><span class="c011">rdf:first</span><span class="c011"> )</span><span class="c011">
</span><span class="c011"> ( </span><span class="c011">sh:alternativePath</span><span class="c011"> [ </span><span class="c011">sh:zeroOrMorePath</span><span class="c011"> </span><span class="c011">rdf:rest</span><span class="c011"> ] </span><span class="c011">rdf:first</span><span class="c011"> )</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:inversePath</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:zeroOrMorePath</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:oneOrMorePath</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:zeroOrOnePath</span><span class="c011">
</span><span class="c011">) .</span><span class="c011">
</span><span class="c011">
</span><span class="c011">:PathNodeShape</span><span class="c011"> </span><span class="c011">sh:xone</span><span class="c011"> (</span><span class="c011">
</span><span class="c011"> [ </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> ]</span><span class="c011">
</span><span class="c011"> [ </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:BlankNode</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:PathListWithAtLeast2Members</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> ]</span><span class="c011">
</span><span class="c011"> [ </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:BlankNode</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:closed</span><span class="c011"> </span><span class="c011">true</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:alternativePath</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:PathListWithAtLeast2Members</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:minCount</span><span class="c011"> 1 ; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">   ]</span><span class="c011">
</span><span class="c011"> ]</span><span class="c011">
</span><span class="c011"> [ </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:BlankNode</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:closed</span><span class="c011"> </span><span class="c011">true</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">   </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> </span><span class="c011">sh:inversePath</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011">    </span><span class="c011">sh:minCount</span><span class="c011"> 1 ; </span><span class="c011">sh:maxCount</span><span class="c011"> 1 ;</span><span class="c011">
</span><span class="c011">   ]</span><span class="c011">
</span><span class="c011"> ]</span><span class="c011">
</span><span class="c011">  ...</span><span class="c011"><em><span class="c011"># similar for sh:zeroOrMorePath, sh:oneOrMorePath </span></em></span><span class="c011">
</span><span class="c011">     </span><span class="c011"><em><span class="c011"># and sh:zeroOrOnePath</span></em></span><span class="c011">
</span><span class="c011"> ) .</span></td></tr>
</table><p>The previous definitions use the following auxiliary shape 
<code>:PathListWithAtLeast2Members</code>:</p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:PathListWithAtLeast2Members</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:node</span><span class="c011"> </span><span class="c011">:ListShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:property</span><span class="c011"> [ </span><span class="c011">sh:path</span><span class="c011"> [ </span><span class="c011">sh:oneOrMorePath</span><span class="c011"> </span><span class="c011">rdf:rest</span><span class="c011"> ] ;</span><span class="c011">
</span><span class="c011">        </span><span class="c011">sh:minCount</span><span class="c011"> 2 ; </span><span class="c011"><em><span class="c011"># 1 other list node plus rdf:nil   </span></em></span><span class="c011">
</span><span class="c011"> ] .</span></td></tr>
</table><p>The last two definitions declare that the values of 
<code>sh:shapesGraph</code> and the values of 
<code>sh:entailment</code> must be IRIs. </p><table class="lstframe c014"><tr><td class="lstlisting"><span class="c011">:ShapesGraphShape</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:targetObjectsOf</span><span class="c011"> </span><span class="c011">sh:shapesGraph</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> .</span><span class="c011">
</span><span class="c011">
</span><span class="c011">:EntailmentShape</span><span class="c011"> </span><span class="c011">a</span><span class="c011"> </span><span class="c011">sh:NodeShape</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:targetObjectsOf</span><span class="c011"> </span><span class="c011">sh:entailment</span><span class="c011"> ;</span><span class="c011">
</span><span class="c011"> </span><span class="c011">sh:nodeKind</span><span class="c011"> </span><span class="c011">sh:IRI</span><span class="c011"> .</span></td></tr>
</table>
<h2 class="section" id="sec191">6.7  Summary</h2>
<p>
<a id="ch6.sec6"></a></p><ul class="itemize"><li class="li-itemize">ShEx and SHACL can be used to describe and validate linked data portals.
We show how they can be used to describe the WebIndex data model. </li><li class="li-itemize">FHIR describes an abstract information model which can be represented in JSON, XML, and RDF. FHIR/RDF data model is described using ShEx.</li><li class="li-itemize">Springer Nature SciGraph is an early adopter of SHACL to validate data.</li><li class="li-itemize">DBpedia is an example of a big linked data portal whose needs for validation offer new challenges. </li><li class="li-itemize">The RDF representation of ShEx can be described and validated in ShEx.</li><li class="li-itemize">SHACL Core shapes graphs can be described and validated in SHACL.</li></ul>
<h2 class="section" id="sec192">6.8  Suggested Reading</h2>
<p>
<a id="ch6.sec7"></a></p><ul class="itemize"><li class="li-itemize">
Paper describing the WebIndex: <a href="bookHtml019.html#LabraValidatingDescribingDataPortalsArxivVersion2017">Labra Gayo, Prud’hommeaux, Solbrig, and
Boneva</a>,<a href="bookHtml019.html#LabraValidatingDescribingDataPortalsArxivVersion2017">2017</a> [<a href="bookHtml019.html#LabraValidatingDescribingDataPortalsArxivVersion2017">58</a>]
</li><li class="li-itemize">FHIR linked data model.
Describes the RDF data model used in FHIR and its use of ShEx: <a href="bookHtml019.html#FHIR_LinkedDataModule">Booth</a>,<a href="bookHtml019.html#FHIR_LinkedDataModule">2017</a> [<a href="bookHtml019.html#FHIR_LinkedDataModule">12</a>].
</li><li class="li-itemize">Paper describing the use of RDFUnit on DBpedia as well as other 
large-scale RDF datasets: <a href="bookHtml019.html#kontokostasDatabugger">Kontokostas, Westphal, Auer, Hellmann,
Lehmann, Cornelissen, and Zaveri</a>,<a href="bookHtml019.html#kontokostasDatabugger">2014</a> [<a href="bookHtml019.html#kontokostasDatabugger">53</a>]
</li><li class="li-itemize">Paper describing the mappings-based validation applied in DBpedia: <a href="bookHtml019.html#iswc15_rml_rdfunit">Dimou, Kontokostas, Freudenberg, Verborgh, Lehmann,
Mannens, Hellmann, and Van de Walle</a>,<a href="bookHtml019.html#iswc15_rml_rdfunit">2015</a> [<a href="bookHtml019.html#iswc15_rml_rdfunit">31</a>]
</li><li class="li-itemize">Paper describing the integration of SHACL with Travis CI for validating DBpedia link contributions: <a href="bookHtml019.html#DojchinovskiDBpediaLinks">Dojchinovski, Kontokostas, Rößling,
Knuth, and Hellmann</a>,<a href="bookHtml019.html#DojchinovskiDBpediaLinks">2016</a> [<a href="bookHtml019.html#DojchinovskiDBpediaLinks">32</a>]
</li></ul>
<hr class="footnoterule"><dl class="thefootnotes"><dt class="dt-thefootnotes">
<a id="note42" href="#text42">1</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a href="http://weso.github.io/wiDoc"><span class="c010">http://weso.github.io/wiDoc</span></a></div></dd><dt class="dt-thefootnotes"><a id="note43" href="#text43">2</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a href="http://weso.github.io/landportalDoc/data"><span class="c010">http://weso.github.io/landportalDoc/data</span></a></div></dd><dt class="dt-thefootnotes"><a id="note44" href="#text44">3</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a ><span class="c010">#1</span></a></div></dd><dt class="dt-thefootnotes"><a id="note45" href="#text45">4</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a ><span class="c010">#1</span></a></div></dd><dt class="dt-thefootnotes"><a id="note46" href="#text46">5</a></dt><dd class="dd-thefootnotes"><div class="footnotetext">The original 
<code>Observation</code> resource is at <a href="http://hl7.org/fhir/observation.html"><span class="c010">http://hl7.org/fhir/observation.html</span></a></div></dd><dt class="dt-thefootnotes"><a id="note47" href="#text47">6</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a ><span class="c010">#1</span></a></div></dd><dt class="dt-thefootnotes"><a id="note48" href="#text48">7</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a href="http://build.fhir.org/observation-example-bloodpressure.ttl"><span class="c010">http://build.fhir.org/observation-example-bloodpressure.ttl</span></a></div></dd><dt class="dt-thefootnotes"><a id="note49" href="#text49">8</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a href="http://www.springernature.com/scigraph"><span class="c010">http://www.springernature.com/scigraph</span></a></div></dd><dt class="dt-thefootnotes"><a id="note50" href="#text50">9</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a href="https://github.com/springernature/scigraph"><span class="c010">https://github.com/springernature/scigraph</span></a></div></dd><dt class="dt-thefootnotes"><a id="note51" href="#text51">10</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a href="http://wiki.dbpedia.org"><span class="c010">http://wiki.dbpedia.org</span></a></div></dd><dt class="dt-thefootnotes"><a id="note52" href="#text52">11</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a ><span class="c010">#1</span></a></div></dd><dt class="dt-thefootnotes"><a id="note53" href="#text53">12</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a href="https://github.com/dbpedia/links"><span class="c010">https://github.com/dbpedia/links</span></a></div></dd><dt class="dt-thefootnotes"><a id="note54" href="#text54">13</a></dt><dd class="dd-thefootnotes"><div class="footnotetext">The SHACL schema was based on an earlier version of SHACL and was adapted to the latest one for this book.</div></dd><dt class="dt-thefootnotes"><a id="note55" href="#text55">14</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a href="https://github.com/dbpedia/ontology-tracker"><span class="c010">https://github.com/dbpedia/ontology-tracker</span></a></div></dd><dt class="dt-thefootnotes"><a id="note56" href="#text56">15</a></dt><dd class="dd-thefootnotes"><div class="footnotetext"><a ><span class="c010">#1</span></a></div></dd></dl>
<hr>
<a href="bookHtml012.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="bookHtml014.html"><img src="next_motif.gif" alt="Next"></a>
</body>
</html>
